/*v0.11.1 Nick's fix*/ var structureJS="undefined"!=typeof structureJS?structureJS:{options:{download_minified:!1,minified_output_tag_id:"minified",log_priority:3,preProcess:!0,minify:!0},state:{dependencyTree:{},resolvedFileList:[],pmiFileOrder:[],declaredGroups:[],groupsInTLC:{},pmiFilesSelectedForExport:"",modules:{},cache:{structureJSTag:null},doneQueue:[],context:{}},extend:function(e,t,n){if(e&&"object"!=typeof e||t&&"object"!=typeof t)throw"Error: extend param is not an an oject";for(var o in t)if(1==Array.isArray(e[o])&&1==Array.isArray(t[o]))e[o]="undefined"!=typeof n&&1==n?t[o].concat(e[o]):e[o].concat(t[o]);else if("object"==typeof e[o]&&"object"==typeof t[o])for(var r in t[o])e[o][r]=t[o][r];else e[o]=t[o]},decodeInfoObj:function(e){var t={name:""};if("string"==typeof e)t.name=e;else if("object"==typeof e){if("undefined"==typeof e.name)throw"Configuration Object Must Have Name Property";this.extend(t,e)}return t},module:function(e,t){function n(e){var t=null;return o.state.modules[e]&&(t=o.state.modules[e].module),t}if("undefined"==typeof e||"string"!=typeof e&&"object"!=typeof e)throw"Module Must Have Configuration Object Or Name String";if("undefined"==typeof t||"function"!=typeof t)throw"Module Must Have A Function As It's Definition";var o=this,r=null,i={type:"unknown"},u=null;if(r=this.decodeInfoObj(e),"undefined"!=typeof r.global_dependencies){if(u=r.global_dependencies,!Array.isArray(u))throw"ERROR: global_dependencies Property Of "+r.name+"s Configuration Object Must Be An Array.";for(var a=0;a<u.length;a++)if("undefined"==typeof window[u[a]])throw"ERROR: "+r.name+" Requires "+u[a]+" To Be In Global Namespace."}n.amd=n,n.getType=function(){var e=null;return o.state.modules[depName]&&(e=o.state.modules[depName].type),e},n._class=n,structureJS.require=n,i.module=t.call(structureJS.state.context,n),this.state.modules[r.name]=i},moduleAMD:function(e,t){var n={type:"amd",name:e};if(n.module=t.call(null).call(null),"undefined"==typeof n.module)throw"Module Function Definition Must Return Something";this.state.modules[e]=n},declare:function(e,t){if("string"!=typeof e)throw"Parameter 'name' must be a string.";"undefined"!=typeof t&&Array.isArray(t)||(t=[]),this.state.dependencyTree[e]=t},declareGroup:function(e){var t=this,n=this.decodeInfoObj(e);this.state.declaredGroups.push(n.name),this.declare(n.name),this[n.name]={};var o=this[n.name];o.state={dependencyTree:{},declaredGroups:[]},o.declare=function(e,n){t.declare.apply(o,[e,n])}},cache:function(e,t){var n=null;return 1==arguments.length&&this.state.cache[e]&&(n=this.state.cache[e]),2==arguments.length&&e&&t&&(this.state.cache[e]=t),n},setContext:function(e){this.state.context=e},extendContext:function(e){this.extend(this.state.context,e)},circular:function(e){if("undefined"==typeof e)return this.circular;var t=structureJS.state.modules[e],n=t.module;return n}};!function(){window.define=function(){},window.define.amd={jQuery:!0},window.console&&0!=structureJS.options.log||(window.console={log:function(){},logf:function(){}})}();window.structureJS.module("Constants",function(){var e={};e.MODEL_ATTRIB_KEY="aplAttrib",e.MODEL_ATTRIB_REPEAT_KEY="aplRepeat",e.TARGET_ATTRIB_KEY="aplTarget",e.CTRL_KEY="aplControl",e.CTRL_ATTRIB_STRING="data-apl-control",e.IE_MODEL_ATTRIB_KEY="apl-attrib",e.IE_MODEL_REPEAT_KEY="apl-repeat",e.IE_TARGET_ATTRIB_KEY="apl-target",e.IE_CTRL_ATTRIB_KEY="apl-control",e.IE_DEFAULT_ATTRIB_KEY="apl-default",e.MAIN_CONTENT_ID="apl-content",e.CLASS_SEPARATOR=/,|\s/,e.NT_REGEX=/\w\:\w/,e.RX_TOKEN=/\{\{(\w+\.\w+)(.*)*/,e.RX_ALL_INX=/(\{\{(\w+\.\w+)([^}]*)*\}\})+?/g,e.RX_M_ATTR=/\{\{(\w+)\.(\w+)([^}]*)*/g,e.RX_M_ATTR_TOK=/\{\{(\w+)\.([\w\d_\-\.\[\]]+)\}\}+?/gm,e.RX_IDX_ITER=/\[(\w+|\d+)\]|\.(\w+)/g,e.RX_ANNOT=/%(\w+)%([^%]+)%\/(?:\w+)%/g,e.RX_RPT_M_ATTR=/(\w+\.\w+)(.*)*/g,e.RX_RPT_ALL_INX=/((\w+\.\w+)([^}]*)*)/g,e.RX_RPT_SPC_SYM=/\{\{(\$*\w+)*\}\}/g,e.TEXT_NODE=3,e.ELEMENT_NODE=1,e.UNINDEXED=-1,e.NON_TERMINAL=0,e.TERMINAL=1,e.STACK=0,e.QUEUE=1,e.COMPILE_ME=1,e.NO_COMPILE_ME=0,e.RECOMPILE_ME=-1,e.SYSTEM_EVENT_TYPES={system:"TMP_SYSTEM",interpolation_done:"interp_done",link_done:"interp_done",repeat_built:"repeat_built",framework_loaded:"fw_loaded",LIST_TYPE:e.QUEUE},e.MODEL_EVENT_TYPES={interp_change:"i_change",select_change:"s_change",checkbox_change:"cb_change",reassignment:"reassignment"},e.RESTRICTED="RESTRICTED",e.DOM_MDL_NAME="model",e.DOM_ATTR_NAME="attrib",e.DOM_TOKEN="token",window.structureJS.extendContext(e)});window.structureJS.module("Util",function(){"use strict";var e={};return e.isDef=function(e){return"undefined"!=typeof e},e.isString=function(t){return e.isDef(t)&&"string"==typeof t},e.isFunc=function(t){return e.isDef(t)&&"function"==typeof t},e.isNull=function(e){return null===e},e.isObject=function(t){return e.isDef(t)&&Object.keys(t).length>0},e.isNullOrEmpty=function(t){return!e.isDef(t)||null===t||""===t},e.isArray=function(t){return!e.isNull(t)&&Array.isArray(t)},e.log=function(e){console.log(e)},e.isInt=function(t){return e.isDef(t)&&/^-?[0-9]+$/.test(t)},e.isObj=function(e){return null===e||"undefined"==typeof e?!1:"function"==typeof e||"object"==typeof e},e.isNotNull=function(t){return e.isDef(t)&&!e.isNull(t)},e.isTrue=function(t){return e.isDef(t)&&t===!0},e.isFalse=function(t){return e.isDef(t)&&t===!1},e.Default=function(t,n){return e.isDef(t)?t:n},e.mixin=function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},e.length=function(t){var n=0;return e.isObj(t)&&(n=Object.keys(t).length),n},e.forIn=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t.call(e,n)},window.structureJS.extendContext(e),e.isDef(window.structureJS.done)||Object.defineProperty(window.structureJS,"done",{set:function(){},get:function(){return function(e){this.state.doneQueue.push(e);var t=window.onload||function(){};window.onload=function(){t.call(null),e.call(null)}}}}),e});window.structureJS.module("TMP_Node",function(){"use strict";var e=this,t=function(n,i,o,r){return this instanceof t?(this.node=n,this.modelName=i,this.attribName=o,this.index=e.isDef(r)?r:-1,this.symbolMap={},this.hasNonTerminals=!1,this.embeddedModelAttribs={},this.embeddedRepeats={},this.scope="",this.hasAttributes=!1,this.repeatModelName="",this.repeatAttribName="",this.repeatIndex=e.UNINDEXED,this.isComponent=!1,this.componentName="",this.indexQueue=[],this.token={},void(this.fullToken="")):new t(n,i,o,r)};return t.prototype.inheritToken=function(t){e.isDef(t)&&(this.modelName=t.modelName,this.attribName=t.attribName,this.repeatModelName=t.repeatModelName,this.repeatAttribName=t.repeatAttribName,this.repeatIndex=t.repeatIndex,this.indexQueue=t.indexQueue.slice(0),this.fullToken=t.fullToken)},t});window.structureJS.module("ModelHeader",function(){"use strict";var e=this,t=window.structureJS.circular(),n=function(i,o){if(!(this instanceof n))return new n(o);this.modelName=i;for(var r in o)o.hasOwnProperty(r)&&(t("Map").annotateWithLimitProps(this,r,o[r]),Object.defineProperty(this,r,{set:function(n,i){return function(o){e.log("SET FIRED for "+i.modelName+"."+n),e.isDef(i.filterResults[n])&&delete i.filterResults[n],e.isDef(i.cachedResults[n])&&delete i.cachedResults[n],t("Map").annotateWithLimitProps(i,n,o),t("Map").setAttribute(i.modelName,n,o),t("Interpolate").interpolate(i.modelName,n,o)}}(r,this),get:function(e,t){return function(){return t.attributes[e]}}(r,this)}));this.attributes=o,this.cachedResults={},this.filterResults={},this.limitTable={},this.liveFilters={}};return n});window.structureJS.module("Attribute",function(){"use strict";var e=this,t=function(e){return this instanceof t?(this.onCreate=function(){},this.onChange=function(){},void(this.name=e||"")):new t},n=function(t){var n=!1;return e.isString(t)&&(n=e.isDef(window.Templar._attributes[t])),n};return t.prototype.getAttribute=function(e){var t=null,i=e.toLowerCase();return n(i)&&(t=window.Templar._attributes[i]),t},t});window.structureJS.module("Component",function(){"use strict";var e=window.structureJS.circular(),t=this,n=function(e,t,i){return this instanceof n?(this.attributes=e||{},this.onCreate=t||function(){},this.onDone=null,this.onChange=null,this.templateURL=i||"",this.templateContent="",this.templateStyle=null,void(this.transclude=!1)):new n};return n.prototype.compile=function(t){e("Compile").compile(t,t.scope)},n.prototype.dereference=function(t){for(var n=e("Compile").getTokens(t),i=e("Map"),r=[],o=0;o<n.length;o++)n[o].attribute=i.dereferenceAttribute(n[o]),n[o].model=i.getModel(n[o].modelName),n[o].data={},r.push(n[o]);return r},n.prototype.defineSelector=function(e,n,i){t.isArray(e.attribute)&&!t.isDef(e.attribute.noClobber)?(e.attribute.noClobber=!0,e.attribute._value_=i||e.attribute[0],Object.defineProperty(e.attribute,"current_selection",{set:function(t){n.call(e,t)},get:function(){return e.attribute._value_}}),e.attribute.current_selection=e.attribute._value_):t.log("WARNING: Selector binding failed b/c attribute is not array")},n});window.structureJS.module("Token",function(){"use strict";var e=this,t=function(n,i){return this instanceof t?(this.start="",this.end="",this.fullToken="",this.modelName=n||"",this.attribName=i||"",this.repeatModelName="",this.repeatAttribName="",this.repeatIndex=e.UNINDEXED,void(this.indexQueue=[])):new t(n,i)};return t.prototype.equals=function(t){if(!e.isDef(t.fullToken))return!1;var n=t.fullToken.replace("{{","").replace("}}","");return n==this.fullToken.replace("{{","").replace("}}","")},t});window.structureJS.module("State",function(){"use strict";return{preventUpdate:!1,target:"",aplHideList:"",compilationThreadCount:0,onloadFileQueue:[],hasDeclaredRoutes:!1,compiledScopes:"",ignoreHashChange:!1,ignoreKeyUp:!1,dispatchListeners:!0,blockBodyCompilation:!1}});window.structureJS.module("DOM",function(e){"use strict";var t=window.structureJS.circular(),n=e("State"),i=this;return{modifyClasses:function(e,t,n){var r="",o=n.split(i.CLASS_SEPARATOR);if(!i.isNull(e)){r=e.getAttribute("class"),r=i.isNull(r)?"":r.trim();for(var a=0;a<o.length;a++)r=r.replace(o[a],"","g");e.setAttribute("class",r+" "+t)}},appendTo:function(e,t){i.isDef(t)&&i.isDef(e)&&!i.isNull(t.parentNode)&&t.parentNode.insertBefore(e,e.nextSibling)},cloneAttributes:function(e,t,n){var r=null,o=null;if(n=i.isDef(n)?!0:!1,e.hasAttributes()){o=e.attributes;for(var a=0;a<o.length;a++)"data-apl-repeat"!=o[a].name&&"style"!=o[a].name&&(n===!1?t.setAttribute(o[a].name,o[a].value):(r=i.isNullOrEmpty(r=t.getAttribute(o[a].name))?"":r+" ",t.setAttribute(o[a].name,r+o[a].value)))}},asynGetPartial:function(e,t,r,o){var a=new XMLHttpRequest;a.onload=t,a.fileName=e,a.targetId=r,a.targetNode=o,a.onreadystatechange=function(){4===a.readyState&&(n.compilationThreadCount--,404===a.status&&i.log('WARNING(404): FILE "'+a.fileName+'" NOT FOUND'))},i.isNullOrEmpty(a.fileName)||(n.compilationThreadCount++,a.open("get",e,!0),a.send())},fetchNestedRouteFiles:function(e,r){var o=new XMLHttpRequest,a=null;i.isNotNull(a=e.shift())&&(o.onload=t("Bootstrap").loadPartialIntoTemplate,o.fileName=a.partial,o.targetId=a.target,o.route=a.route,o.fallback=a.fallback||"",o.callbackOnComplete=e.onComplete||function(){},o.callbackParam1=e.slice(0),o.callbackParam1.onComplete=e.onComplete,o.callback=function(){0===this.callbackParam1.length?(this.callbackOnComplete.call(null),this.fileName=r):t("DOM").fetchNestedRouteFiles.call(null,this.callbackParam1,r)},o.onreadystatechange=function(){4===o.readyState&&(n.compilationThreadCount--,404===o.status&&(i.log('WARNING(404): FILE "'+o.fileName+'" NOT FOUND'),i.isNullOrEmpty(o.fallback)||(i.log('WARNING (404): ATTEMPTING FALLBACK ROUTE "'+o.fallback+'".'),t("Route").open(o.fallback))))},i.isNullOrEmpty(o.fileName)||(n.compilationThreadCount++,i.log("FETCHIGN: "+o.fileName),o.open("get",o.fileName,!0),o.send()))},buildOnloadList:function(e){var t=[];return i.isArray(e)&&e.forEach(function(e){i.isObj(e)?t.unshift(e.partial):(t.unshift(e),n.onloadFileQueue.unshift(e))}),t.join(",")},asynFetchRoutes:function(e,r){n.onloadFileQueue.length=0;var o=[],a="";o.onComplete=r||function(){},i.isArray(e.partial)?(a=this.buildOnloadList([e.route].concat(e.partial)),t("Route").deferenceNestedRoutes(e.partial,o)):(a=e.route+","+e.partial,n.onloadFileQueue.unshift(e.route),o.push(e)),this.fetchNestedRouteFiles(o,a)},insertAfter:function(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e},splitText:function(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),this.insertAfter(n,e),n},getHashValue:function(e){return i.isString(e)?e.substring(e.indexOf("#")).replace("#",""):""},getDataAttribute:function(e,t){var n=i.isString(t)?t.split("-"):[],r=null,o=n.slice(0,1).concat(n.slice(1).map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join("");return i.isNull(e)||(r=i.isDef(e.dataset)?e.dataset[o]:e.getAttribute("data-"+t)),i.isNull(r)?"":r},annotateDOMNode:function(e,t,n,r){e[i.DOM_MDL_NAME]=t||"",e[i.DOM_ATTR_NAME]=n||"",e[i.DOM_TOKEN]=r||e[i.DOM_TOKEN]||null},getDOMAnnotations:function(e){return{modelName:e[i.DOM_MDL_NAME],attribName:e[i.DOM_ATTR_NAME],token:e[i.DOM_TOKEN]}}}});window.structureJS.module("Map",function(e){var t=this,n={},i={};i[t.SYSTEM_EVENT_TYPES.system]={},i[t.SYSTEM_EVENT_TYPES.system].listeners={};var r=e("TMP_Node");return{buildAttribAlias:function(e){return"_"+e},getRepeatBaseNodes:function(e,i){var r=[];return t.isDef(i)&&t.isDef(e)&&t.isDef(n[e])&&t.isDef(n[e][i])&&(r=n[e][i]),r},pruneBaseNodes:function(e){for(var n=0;n<e.length;n++)(t.isNull(e[n].node.parentNode)||!document.body.contains(e[n].node))&&(e.splice(n,1),n--)},isRepeatedAttribute:function(e,t){return this.getRepeatBaseNodes(e,t).length>0},addRepeatBaseNode:function(e){t.isDef(n[e.modelName])||(n[e.modelName]={}),t.isDef(n[e.modelName][e.attribName])||(n[e.modelName][e.attribName]=[]),n[e.modelName][e.attribName].push(e)},exists:function(e){return t.isDef(i[e])},contains:function(e,n){if(!t.isArray(e))return!1;for(var i=!1,r=0;r<e.length;r++)if(e[r]===n){i=!0;break}return i},isInScopeList:function(e,n,i){var r=null,o=t.isDef(e)?e.split(" "):[],a=!1;if(i=t.isDef(i)?i:!1,n=t.isDef(n)?n.split(","):[],n.length>0){o=o.length>1?o:[null,null],r=n.map(function(e){var t=e.split(" ");return t.length>1?t:[null,null]});for(var l=0;l<r.length;l++)if(!t.isNullOrEmpty(o[0])&&!t.isNullOrEmpty(r[l][0])&&o[0]==r[l][0]){a=i===!0?!0&&o[1]==r[l][1]:!0;break}}return a},forEach:function(e,n,r){var o=null,a={},l="";if(a.endingIndex=0,a.modelName="",a.modelAtrribName="",a.hasAttributes=!1,a.stop=!1,a.target=null,a.targetCopy=null,a.key="",a.length=0,a.index=0,a.modelAttribIndex=0,a.modelAttribLength=0,a.removeItem=function(e){a.target.splice(e,1),a.index--},t.isFunc(e)){r=e,o=i;for(var s in o)o.hasOwnProperty(s)&&r.call(null,{modelName:s},s)}else if(!t.isFunc(e)&&t.isFunc(n)){r=n,l="",o=t.isDef(i[e])&&t.isDef(i[e].nodeTable)?i[e].nodeTable:{};for(var u in o)o.hasOwnProperty(u)&&(a.modelName=e,a.modelAtrribName=u,r.call(null,a,u))}else if(!t.isFunc(e)&&!t.isFunc(n)&&t.isFunc(r)){var c=null,f={};if(t.isDef(i[e].nodeTable[n]))for(a.target=i[e].nodeTable[n].nodes,a.endingIndex=a.target.length;a.index<a.target.length&&a.index<a.endingIndex;a.index++,f={}){c=a.target[a.index];for(var d=0;d<a.target.length;d++)a.target[d].index>t.UNINDEXED&&c.scope==a.target[d].scope&&(f[a.target[d].index]=!0);a.modelAttribLength=Object.keys(f).length,a.modelName=e,a.modelAtrribName=n,a.modelAttribIndex=c.index,a.hasAttributes=Object.keys(a.target[a.index].symbolMap).length>0?!0:!1,r.call(null,a,c)}}},pushNodes:function(e,n,o,a){var l=e;l instanceof r||(l=new r(e,n,o,a)),t.isDef(i[l.modelName])?(t.isDef(i[l.modelName].nodeTable[l.attribName])||(i[l.modelName].nodeTable[l.attribName]={nodes:[]}),i[l.modelName].nodeTable[l.attribName].nodes.push(l)):t.log('WARNING: Model "'+l.modelName+" Is Undeclared.")},annotateWithLimitProps:function(e,n,i){t.isArray(i)&&!t.isDef(i.page)&&(Object.defineProperty(i,"page",{set:function(t){e.gotoPage(t).of(n)},get:function(){return e.currentPageOf(n)}}),Object.defineProperty(i,"totalPages",{set:function(){},get:function(){return e.totalPagesOf(n)}}),Object.defineProperty(i,"limit",{set:function(t){e.limit(n).to(t)},get:function(){var i=t.isDef(e.limitTable[n])?e.limitTable[n].limit:0;return i}}))},getPageSlice:function(e,n,i){var r=0,o=i.length,a=0,l=0,s=i;return t.isDef(e.limitTable[n])&&t.isArray(i)&&(l=e.limitTable[n].page,a=e.limitTable[n].limit,e.limitTable[n].totalPages=Math.floor(s.length/a),e.limitTable[n].totalPages+=s.length%a>0?1:0,o=a*l<=i.length?a*l:i.length,r=o>l*a-a?l*a-a:0,s=i.slice(r,o),this.annotateWithLimitProps(e,n,s)),s},getAttribute:function(e,n,r,o){if(!t.isDef(i[e]))return null;var a=null,l=i[e].api;return t.isDef(i[e])&&t.isDef(i[e].modelObj[n])&&(a=i[e].modelObj[n]),t.isDef(i[e].filterResults[n])&&(a=i[e].filterResults[n]),t.isDef(l.limitTable[n])&&l.limitTable[n].limit>0&&(a=this.getPageSlice(l,n,a)),t.isDef(i[e].cachedResults[n])&&(a=i[e].cachedResults[n]),t.isDef(r)&&t.isDef(o)&&t.isArray(a)&&t.isDef(a[r][o])?a=a[r][o]:t.isDef(r)&&t.isArray(a[r])&&t.isDef(a[r])&&(a=a[r]),a},dereferenceAttribute:function(e){if(!t.isDef(i[e.modelName]))return null;var n=null,r=null,o=null,a=e.indexQueue.slice(0),l=e.modelName,s=e.attribName,u=i[l].api;if(r=n=this.getAttribute(l,s),t.isNull(r))t.log("WARNING: "+s+" is not member of model "+l);else if(t.isArray(r)||t.isObj(r))if(1==a.length&&"length"===a[0])n=t.isDef(u.cachedResults[s])?u.cachedResults[s].length:u.attributes[s].length;else for(;t.isNotNull(o=a.shift());)n=r=r[o];else n=r;return n},setAttribute:function(e,n,r){var o=null;return t.isDef(i[e])&&t.isDef(i[e].modelObj[n])&&(t.isArray(r)&&this.annotateWithLimitProps(i[e].api,n,r),i[e].modelObj[n]=r),o},setAttributeWithToken:function(e,n){if(!t.isDef(i[e.modelName]))return null;var r=null,o=null,a=null,l=null,s=e.indexQueue.slice(0),u=e.modelName,c=e.attribName;if(t.isDef(a=this.getAttribute(u,c)))if(t.isArray(a)||t.isObj(a)){for(;t.isNotNull(l=s.shift())&&t.isDef(a[l]);)r=a,o=l,a=a[l];r[o]=n}else this.setAttribute(u,c,n)},getListeners:function(e,n){var r=[];return t.isDef(i[e].listeners[n])&&(r=i[e].listeners[n]),r},getFuncHash:function(e){var t=e.toString(),n=t.length+t.charAt(t.length/2);return n},setListener:function(e,n,r,o){if(t.isFunc(r)){var a=this.getFuncHash(r);t.isDef(o)&&o===!0&&(a="_LIVE_FILTER_"+a+Math.random(),t.log("Adding duplicate with hash "+a+" on "+e+"."+n)),t.isDef(i[e].listeners[n])||(i[e].listeners[n]={}),i[e].listeners[n][a]=r}},removeAllListeners:function(e,t){delete i[e].listeners[t]},removeListener:function(e,t,n){var r=i[e].listeners[t],o=this.getFuncHash(n);for(var a in r)o==a&&delete r[a]},isDuplicateListener:function(e,t,n){var i=this.getListeners(e,t);for(var r in i)if(n.toString()==i[r].toString())return!0;return!1},removeFilterListeners:function(e,n){if(t.isDef(i[e].listeners[n])){var r=i[e].listeners[n];for(var o in r)0===o.indexOf("_LIVE_FILTER_")&&(t.log("REMOVING Listener with hash: "+o),delete r[o])}},getModel:function(e){var n=null;return this.exists(e)?n=i[e].api:t.log('WARNING: Attempt To Get Model "'+e+'" Failed.'),n},initModel:function(e){i[e.modelName]={modelObj:e.attributes,nodeTable:{},api:e,listeners:{},cachedResults:e.cachedResults,limitTable:e.limitTable,filterResults:e.filterResults}},isRepeatArrayProperty:function(e){return 1==e.indexQueue.length&&!t.isInt(e.indexQueue[0])},destroyRepeatTree:function(e,n){this.forEach(e,n,function(e,n){(n.index>-1||!document.body.contains(n.node))&&e.removeItem(e.index),document.body.contains(n.node)&&n.index>t.UNINDEXED&&n.node.parentNode.removeChild(n.node)})},pruneDeadEmbeds:function(){var e=this;e.forEach(function(n){e.forEach(n.modelName,function(n){e.forEach(n.modelName,n.modelAtrribName,function(e,n){var i=n.node;t.isNullOrEmpty(n.repeatModelName)||t.isNullOrEmpty(n.repeatAttribName)||document.body.contains(i)||e.removeItem(e.index)})})})},pruneNodeTreeByScope:function(e){if(!t.isNullOrEmpty(e)){var n=null,i=this;i.forEach(function(r){i.forEach(r.modelName,function(r){i.forEach(r.modelName,r.modelAtrribName,function(r,o){var a=o.node;t.isNotNull(n=o.scope.split(" "))&&i.isInScopeList(o.scope,e)&&!i.isInScopeList(o.scope,e,!0)&&(r.removeItem(r.index),t.log("Pruning "+a.tagName+" for "+r.modelName+"."+r.modelAtrribName+" scope: "+n[0]+" "+n[1]))})})})}},getInternalModel:function(e){var t=null;return this.exists(e)&&(t=i[e]),t},getMap:function(){return i},getRepeat:function(){return n}}});window.structureJS.module("System",function(e){"use strict";var t=this,n=e("Map");return{setSystemListeners:function(e,i){var r=t.SYSTEM_EVENT_TYPES.system,o=n.getMap(),a=o[r].listeners[r];t.isFunc(i)&&(t.isDef(a)||(a=o[r].listeners[r]={}),t.isDef(a[e])||(a[e]=[]),a[e].push(i))},getSystemListeners:function(e){var i=t.SYSTEM_EVENT_TYPES.system,r=n.getMap(),o=r[i].listeners[i],a=[];return t.isNullOrEmpty(e)||t.isDef(o)&&t.isDef(o[e])&&(a=o[e]),a},removeSystemListeners:function(e){var i=t.SYSTEM_EVENT_TYPES.system,r=n.getMap(),o=r[i].listeners[i];t.isNullOrEmpty(e)||t.isDef(o)&&t.isDef(o[e])&&delete o[e]}}});window.structureJS.module("Process",function(e){"use strict";var t=this,n=e("TMP_Node"),i=e("Map"),r=e("DOM"),o=e("State"),a=e("Attribute")(),s=window.structureJS.circular();return{parseModelAttribName:function(e){return t.isDef(e)?e.split("."):["",""]},buildNT:function(e){for(var n,i=e.modelName+"."+e.attribName,r=t.isArray(e.indexQueue)?e.indexQueue.slice(0):[],o="";t.isNotNull(n=r.shift(r));)o+="["+n+"]";return"{{"+i+o+"}}"},buildItemNT:function(e,t){return e.modelName+"."+e.attribName+"["+t+"]"},checkForCustomAttribute:function(e,n){var i;t.isNotNull(i=a.getAttribute(n))&&(t.isDef(e.__customAttributes__)||(e._setAttribute=e.setAttribute,e.__customAttributes__={},e.setAttribute=function(e,t){var n=e.toLowerCase();for(var i in this.__customAttributes__)this.__customAttributes__[i].name==n&&this.__customAttributes__[i].onChange.call(this.__customAttributes__[i],this,t);this._setAttribute.call(this,e,t)}),e.__customAttributes__[i.name]=i,i.onCreate.call(i,e))},preProcessNodeAttributes:function(e,r,o){var a,l,u,c=null,d=null,f=[],m=s("Interpolate");if(o=t.isInt(o)?parseInt(o):-1,e.hasAttributes()&&"OPTION"!=e.tagName){c=e.attributes;for(var p=0;p<c.length;p++){a=c[p].value,l=c[p].name,this.checkForCustomAttribute(e,l),u=s("Compile").getAllTokens(a);for(var h=0;h<u.length;h++)(null===d||null!==d&&!u[h].equals(d))&&(d=new n(e,u[h].modelName,u[h].attribName,o),d.inheritToken(u[h]),i.pushNodes(d)),d.symbolMap[l]=a,d.scope=r,m.updateNodeAttributes(d,d.modelName,d.attribName),f.push(d)}}return f},_preProcessRepeatAttributes:function(e,n,i){var r,o,a,s=null,l=!1;if(e.hasAttributes()){r=e.attributes;for(var u=0;u<r.length;u++){for(o=r[u].value,t.RX_RPT_SPC_SYM.lastIndex=0;t.isNotNull(s=t.RX_RPT_SPC_SYM.exec(o));)l=!0,a=s[0],"{{}}"==a&&(n.indexQueue.push(i),o=o.replace(a,this.buildNT(n)),n.indexQueue.pop()),"{{$index}}"==a&&(o=o.replace(a,i)),"{{$item}}"==a&&(o=o.replace(a,this.buildItemNT(n,i))),"{{}}"!=a&&"{{$index}}"!=a&&(n.indexQueue.push(i),n.indexQueue.push(s[1]),o=o.replace(a,this.buildNT(n)),n.indexQueue.pop(),n.indexQueue.pop());e.setAttribute(r[u].name,o)}}return l},_preprocessInPlace:function(e,n){var i=null,r=null,o=null,a=e.node.nodeValue,s="",l="";for(e.hasNonTerminals=!0,r=e.node.nodeValue,t.RX_RPT_SPC_SYM.lastIndex=0;t.isNotNull(i=t.RX_RPT_SPC_SYM.exec(e.node.nodeValue));)l=i[0],"{{}}"==l&&(e.indexQueue.push(n),r=r.replace(l,this.buildNT(e)),e.indexQueue.pop()),"{{$index}}"==l&&(r=r.replace(l,n)),"{{$item}}"==l&&(r=r.replace(l,this.buildItemNT(e,n))),"{{}}"!=l&&"{{$index}}"!=l&&(e.indexQueue.push(n),e.indexQueue.push(i[1]),r=r.replace(l,this.buildNT(e)),e.indexQueue.pop(),e.indexQueue.pop());for(e.node.nodeValue=r,t.RX_M_ATTR_TOK.lastIndex=0;t.isNotNull(o=t.RX_M_ATTR_TOK.exec(a))&&!/%(\w+)%/.test(a);)(o[1]!=e.modelName||o[2]!=e.attribName)&&(e.embeddedModelAttribs[o[1]+"."+o[2]]=!0,s=o[0].replace("}}","")+"%mdl%"+e.modelName+"%/mdl%%att%"+e.attribName+"%/att%%i%"+n+"%/i%}}",e.node.nodeValue=e.node.nodeValue.replace(o[0],s));return e.hasNonTerminals=e.hasNonTerminals===!1?!t.isNullOrEmpty(e.node.nodeValue.trim()):e.hasNonTerminals,e.hasNonTerminals},_cloneBaseNode:function(e,t){var i=null,o=document.createElement(e.node.tagName.toLowerCase()),a=new n(o,e.modelName,e.attribName,t);return r.cloneAttributes(e.node,a.node),i=e.node.getAttribute("id"),i=null===i?"":a.node.setAttribute("id",i+"-"+t),a.hasNonTerminals=e.hasNonTerminals,a.node.innerHTML=e.node.innerHTML,a},_traverseRepeatNode:function(e,i,o){for(var a=null,l="",u=null,c=!1,d=0;d<e.length;d++){if(e[d].nodeType==t.ELEMENT_NODE){if(c|=this._preProcessRepeatAttributes(e[d],o,i),l=r.getDataAttribute(e[d],t.IE_MODEL_REPEAT_KEY),(u=s("Compile").getRepeatToken(l)).length>0&&(e[d].token=u[0]),!t.isNullOrEmpty(l)){e[d].setAttribute("data-"+t.IE_MODEL_REPEAT_KEY,l),(u[0].modelName!=o.modelName||u[0].attribName!=o.attribName)&&(o.embeddedRepeats[u[0].modelName+"."+u[0].attribName]=!0);continue}if(!e[d].hasChildNodes())continue;c|=this._traverseRepeatNode(e[d].childNodes,i,o)}e[d].nodeType==t.TEXT_NODE&&(a=new n(e[d],o.modelName,o.attribName,i),a.inheritToken(o),c|=this._preprocessInPlace(a,i),t.mixin(a.embeddedModelAttribs,o.embeddedModelAttribs))}return c},preProcessRepeatNode:function(e,n){var i=this._cloneBaseNode(e,n),r=e.node.tmp_component,o=t.isDef(r);return i.hasNonTerminals=this._traverseRepeatNode([i.node],n,e),(!i.node.hasChildNodes()||o)&&(this.preProcessNode(i.node,i.scope),this.preProcessNodeAttributes(i.node,i.scope,n),o&&r.onCreate.call(r,i.node)),i},preProcessTextInput:function(e,n){n=t.isDef(n)?n:"keyup",e.addEventListener(n,function(e){var t=r.getDOMAnnotations(this),n=s("Interpolate");i.setAttributeWithToken(this.token,e.target.value),o.ignoreKeyUp=!0,n.interpolate(t.modelName,t.attribName,e.target.value,void 0,this.token),o.ignoreKeyUp=!1})},addCurrentSelectionToCheckbox:function(e,n){t.isDef(n.current_selection)||!function(e){Object.defineProperty(n,"current_selection",{configurable:!0,set:function(t){this._value_=t;for(var n=document.querySelectorAll("input[name="+e+"]"),i=0;i<n.length;i++)n[i].value==t&&(n[i].checked=!0)},get:function(){return this._value_}})}(e.attrib)},addCurrentSelectionToSelect:function(e,n){n.noClobber!==!0&&(t.isDef(n.current_selection)||(n._value_=n[0].value||n[0]),function(e){Object.defineProperty(n,"current_selection",{configurable:!0,set:function(n){if(""!==n){this._value_=n;for(var a=r.getDOMAnnotations(e),l=t.isDef(e.token.indexQueue)?e.token.indexQueue.slice(0):[],u=s("Interpolate"),c=0;c<e.children.length;c++)(e.children[c].value==n||e.children[c].text==n)&&(e.selectedIndex=c,o.dispatchListeners=!1,u.interpolate(a.modelName,a.attribName),o.dispatchListeners=!0,u.dispatchListeners(i.getListeners(a.modelName,a.attribName),{type:t.MODEL_EVENT_TYPES.select_change,value:e.children[c].value,text:e.children[c].text,index:e.selectedIndex,properties:l}))}},get:function(){return this._value_}})}(e))},bindCheckboxListener:function(e){e.addEventListener("click",function(e){var n=i.dereferenceAttribute(this.token),a=t.isDef(this.token.indexQueue)?this.token.indexQueue.slice(0):[],l={type:t.MODEL_EVENT_TYPES.checkbox_change,checked:e.target.checked===!0,value:e.target.value,target:e.target,properties:a},u=r.getDOMAnnotations(this),c=i.getListeners(u.modelName,u.attribName),d=s("Interpolate");n._value_=l.checked===!0?e.target.value:!1,n.checked[this.getAttribute("id")]=l.checked,o.dispatchListeners=!1,d.interpolate(u.modelName,u.attribName),o.dispatchListeners=!0,d.dispatchListeners(c,l)})},preProcessInputNode:function(e,o){var a,l=e.getAttribute("type")||"",u=s("Compile").getTokens(e.getAttribute("value")),c=t.COMPILE_ME;if(!(u.length<1)){switch(a=u[0],r.annotateDOMNode(e,a.modelName,a.attribName,a),l=l.toLowerCase()){case"checkbox":case"radio":var d=null,f=null,m="",p="",h=!1,N="";if(d=i.dereferenceAttribute(a),t.isArray(d)){d._value_="",t.isDef(d.checked)||(d.checked={});for(var b=0;b<d.length;b++,h=!1)t.isDef(d[b].description)||t.isDef(d[b].value)?(m=t.isDef(d[b].value)?d[b].value:m,p=t.isDef(d[b].description)?d[b].description:p,h=t.isDef(d[b].checked)?d[b].checked:h):m=p=d[b],N=t.isDef(d[b].id)?d[b].id:b,f=new n(document.createElement("input"),a.model,a.attrib,b),f.scope=o,f.inheritToken(a),f.node.setAttribute("name",a.attribName),f.node.setAttribute("id",N),r.annotateDOMNode(f.node,a.modelName,a.attribName,a),t.isDef(d.checked[N])&&(h=d.checked[N]),d.checked[N]=h,h===!0&&(d._value_=m,f.node.setAttribute("checked",h)),r.cloneAttributes(e,f.node),f.node.setAttribute("value",m),this.addCurrentSelectionToCheckbox(e,d),e.parentNode.insertBefore(f.node,e),e.parentNode.insertBefore(document.createTextNode(p),e),this.bindCheckboxListener(f.node),i.pushNodes(f)}e.parentNode.removeChild(e),c=t.RECOMPILE_ME;break;case"text":this.preProcessTextInput(e);break;case"range":this.preProcessTextInput(e,"change");break;case"date":this.preProcessTextInput(e),this.preProcessTextInput(e,"blur");break;default:this.preProcessTextInput(e)}return c}},preProcessNode:function(e,o,a){if(t.isDef(e)&&null!==e){a=t.isInt(a)?parseInt(a):-1;var l=r.getDataAttribute(e,t.IE_MODEL_REPEAT_KEY),u=t.isNullOrEmpty(l)?e.tagName:"REPEAT",c=[],d=null,f=null,m=t.COMPILE_ME,p=s("Interpolate");switch(u){case"SELECT":var h=null;if(t.RX_M_ATTR.lastIndex=0,(c=s("Compile").getTokens(e.innerHTML)).length<1)break;h=c[0],e.innerHTML="",r.annotateDOMNode(e,h.modelName,h.attribName,h),f=new n(e,h.modelName,h.attribName),f.inheritToken(h),f.scope=o,p.intializeSelect(f,!0,0),i.pushNodes(f),e.addEventListener("change",function(e){var n=i.dereferenceAttribute(this.token),o=t.isDef(this.token.indexQueue)?this.token.indexQueue.slice(0):[],a={type:t.MODEL_EVENT_TYPES.select_change,value:e.target.options[e.target.selectedIndex].value,text:e.target.options[e.target.selectedIndex].text,index:e.target.selectedIndex,target:e.target,properties:o},s=r.getDOMAnnotations(this),l=i.getListeners(s.modelName,s.attribName);n.current_selection=a.value,p.dispatchListeners(l,a)});break;case"INPUT":m=this.preProcessInputNode(e,o);break;case"TEXTAREA":this.preProcessInputNode(e,o);break;case"REPEAT":var N=r.getDOMAnnotations(e);d=new n(e,N.modelName,N.attribName),d.inheritToken(e.token),d.scope=o,i.addRepeatBaseNode(d),m=t.NO_COMPILE_ME}return document.body.contains(e)&&this.preProcessNodeAttributes(e,o,a),m}}}});window.structureJS.module("Interpolate",function(e){"use strict";var t=this,n=e("TMP_Node"),i=e("Map"),r=e("DOM"),o=e("Process"),a=e("System"),s=e("State"),l=window.structureJS.circular();return{dispatchListeners:function(e,n){if(t.isDef(e)&&s.dispatchListeners===!0)for(var i in e)t.isFunc(e[i])&&e[i].call(null,n)},dispatchSystemListeners:function(e,n){if(!t.isNullOrEmpty(e)){var i=a.getSystemListeners(e);if(n=t.isObj(n)?n:{},t.SYSTEM_EVENT_TYPES.LIST_TYPE==t.QUEUE)for(var r=0;r<i.length;r++)t.isFunc(i[r])&&(n.target=i[r].node,i[r].call(i[r].context||null,n));else if(t.SYSTEM_EVENT_TYPES.LIST_TYPE==t.STACK)for(var o=i.length-1;o>=0;o--)t.isFunc(i[o])&&(n.target=i[o].node,i[o].call(i[o].context||null,n))}},updateNodeAttributes:function(e){var n={},r=e.node,o="",a="",s="",u="",d=r.attributes,c=null,f=null,m=null;if(r.hasAttributes()&&e.isComponent===!1){for(var p=0;p<d.length;p++)if(d[p].name!="data-"+t.IE_MODEL_REPEAT_KEY&&(s=d[p].name,a=t.isDef(e.symbolMap[s])?e.symbolMap[s]:"",!t.isNullOrEmpty(a=e.symbolMap[s]))){m=l("Compile").getAllTokens(a);for(var h=0;h<m.length;h++)u=i.dereferenceAttribute(m[h]),t.isArray(u)&&(u=m[h].fullToken),o=a.replace(m[h].fullToken,u),a=o;r.setAttribute(s,o),n[s]=o}}else if(e.isComponent===!0&&(c=window.Templar._components[e.componentName],(f=Object.keys(e.symbolMap)).length>0)){m=l("Compile").getTokens(e.symbolMap[f[0]]);for(var N=0;N<m.length;N++)r.setAttribute(f[0],i.dereferenceAttribute(m[N]))}return n},interpolateSpan:function(e){var n=e.node,r=i.dereferenceAttribute(e)||"",o=n.textContent||n.innerText,a=t.isArray(r)||t.isObj(r)?o:r;t.isDef(n.textContent)?n.textContent=a:n.innerText=a},getPageSlice:function(e,n,i){var r=0,o=i.length,a=0,s=0,l=i;return t.isDef(e.limitTable[n])&&(s=e.limitTable[n].page,a=e.limitTable[n].limit,o=a*s<=i.length?a*s:i.length,r=o>s*a-a?s*a-a:0,l=i.slice(r,o)),l},getPageSliceData:function(e,n,i){var r=0,o=i.length,a=0,s=0,l={};return l.start=-1,l.length=0,t.isDef(e.limitTable[n])&&(s=e.limitTable[n].page,a=e.limitTable[n].limit,o=a*s<=i.length?a*s:i.length,r=o>s*a-a?s*a-a:0,l.start=r,l.length=o),l},interpolateEmbeddedRepeats:function(e,n){var a=null,s=null,u=null,d=null,c=null,f=null,m=null;for(var p in e.embeddedRepeats)if(e.embeddedRepeats.hasOwnProperty(p)&&(f=o.parseModelAttribName(p),d=f[0],c=f[1],a=i.getRepeatBaseNodes(d,c),i.pruneBaseNodes(a),!t.isNull(s=a[n]))){if(r.isVisible(s.node.parentNode)&&t.isArray(u=i.dereferenceAttribute(s)))for(var h=0;h<u.length;h++)m=o.preProcessRepeatNode(s,h),m.scope=s.scope,i.pushNodes(m),m.hasNonTerminals===!1&&(m.node.innerHTML=u[h]),s.node.parentNode.insertBefore(m.node,s.node),l("Compile").compile(m.node,s.scope,h);s.node.setAttribute("style","display:none;")}},intializeSelect:function(e,r,a){var s,l,u,d,c=!t.isNullOrEmpty(e.repeatModelName)&&!t.isNullOrEmpty(e.repeatAttribName),f=r?r&&c:!r&&!c,m=i.dereferenceAttribute(e),p=e.modelName,h=e.attribName,N=m._value_;if(f&&t.isArray(m)){var b=a>0&&0===e.node.children.length;if(b===!0&&i.forEach(e.modelName,e.attribName,function(t,n){"OPTION"==n.node.tagName&&t.modelAttribIndex<a&&e.node.appendChild(n.node)}),m.length>a){s=m.length-a,l=m.length-s;for(var g=0;s>g;g++,l++,a++){var T=new n(document.createElement("option"),p,h,l);T.inheritToken(e),T.node.text=t.isDef(u=m[l].text)?u:m[l],T.node.value=t.isDef(d=m[l].value)?d:m[l],e.node.appendChild(T.node),T.scope=e.scope,e.node.selectedIndex=0,e.node.selectedIndex=t.isNullOrEmpty(N)||T.node.value!=N?e.node.selectedIndex:g,i.pushNodes(T)}}}o.addCurrentSelectionToSelect(e.node,m)},targetedInterpolate:function(e){var n=e.length>0?e[0]:null;t.isNull(n)||this.interpolate(n.modelName,n.attribName,null,void 0,n)},interpolate:function(e,n,a,u,d){if(i.exists(e)){var c=i.getListeners(e,n),f=this,m={},p=null,h={},N=null,b="",g=null,T=[],_=null,E="",A="";i.forEach(e,n,function(v,y){if(!(t.isDef(u)&&!i.isInScopeList(y.scope,u)||t.isDef(d)&&!d.equals(y)))switch(N=y.node,b=y.isComponent===!0?"COMPONENT":N.tagName,b=t.isDef(y.symbolMap["data-"+t.IE_MODEL_REPEAT_KEY])?"REPEAT":N.tagName,v.hasAttributes===!0&&(m=f.updateNodeAttributes(y,e,n)),T=t.isDef(N.token)&&t.isDef(N.token.indexQueue)?N.token.indexQueue.slice(0):[],b){case"SELECT":f.intializeSelect(y,!1,v.modelAttribLength);break;case"OPTION":t.isArray(a=i.dereferenceAttribute(y))&&(_=N.parentNode,a.length<=v.modelAttribLength&&v.modelAttribIndex<a.length&&(N.text=t.isDef(E=a[v.modelAttribIndex].text)?E:a[v.modelAttribIndex],N.value=t.isDef(A=a[v.modelAttribIndex].value)?A:a[v.modelAttribIndex],_.selectedIndex=t.isDef(a[v.modelAttribIndex].selected)&&a[v.modelAttribIndex].selected===!0?v.modelAttribIndex:_.selectedIndex),h.value=_.options[_.selectedIndex].value,h.text=_.options[_.selectedIndex].text,h.type=t.MODEL_EVENT_TYPES.interp_change,h.index=_.selectedIndex,h._attrib_=a,h.properties=T,v.modelAttribIndex>=a.length&&(v.removeItem(v.index),_.removeChild(N)));break;case"SPAN":f.interpolateSpan(y),h.text=N.innerText,h.value=N.innerText,h.type=N.tagName.toLowerCase(),h.properties=T;break;case"INPUT":g=r.getDOMAnnotations(y.node),g.modelName==y.modelName&&g.attribName==y.attribName&&(t.isArray(a=i.dereferenceAttribute(y))||s.ignoreKeyUp!==!1||(N.value=a),h.text=N.value,h.value=N.value,h.type=N.tagName.toLowerCase(),h.target=N,h.properties=T);break;case"TEXTAREA":y.node.value=a,h.text=N.value,h.value=N.value,h.type=N.tagName.toLowerCase(),h.target=N,h.properties=T;break;case"REPEAT":var D=null,x=null;v.endingIndex=v.target.length,i.destroyRepeatTree(e,n),x=i.getRepeatBaseNodes(e,n),i.pruneBaseNodes(x);for(var M=0;M<x.length;M++){if(p=x[M],document.body.contains(p.node)&&t.isArray(a=i.dereferenceAttribute(p))&&a.length>0){for(var O=0;O<a.length;O++)D=o.preProcessRepeatNode(p,O),D.scope=p.scope,i.pushNodes(D),D.hasNonTerminals===!1&&(D.node.innerHTML=a[O]),p.node.parentNode.insertBefore(D.node,p.node),l("Compile").compile(D.node,p.scope,O),o.preProcessNodeAttributes(D.node,p.scope,O),f.interpolateEmbeddedRepeats(p,O);i.pruneDeadEmbeds(),h.type=t.SYSTEM_EVENT_TYPES.repeat_built,h.value=a,h.modelName=y.modelName,h.attribName=y.attribName,h.properties=T,f.dispatchListeners(c,h)}p.node.setAttribute("style","display:none;")}break;default:h.text=null,h.value=null,h.type=t.MODEL_EVENT_TYPES.reassignment,h.target=N,h.properties=T,f.dispatchListeners(c,h)}}),t.isDef(h.type)&&(h.type==t.MODEL_EVENT_TYPES.interp_change&&(h._attrib_._value_=h.value),f.dispatchListeners(c,h))}}}});window.structureJS.module("Compile",function(e){"use strict";var t=this,n=e("TMP_Node"),i=e("Map"),r=e("DOM"),o=e("Interpolate"),a=e("Process"),s=e("State"),l=e("Token"),u=window.structureJS.circular();return{getTokens:function(e,n){var i,r=new l,o=null,s=null,u=[],d=t.RX_TOKEN,c=t.RX_ALL_INX,f=null,p=null,m=null,h=null;for(t.isDef(n)&&n===!0&&(d=t.RX_RPT_M_ATTR,c=t.RX_RPT_ALL_INX),d.lastIndex=0,c.lastIndex=0,t.RX_IDX_ITER.lastIndex=0,t.RX_ANNOT.lastIndex=0;null!==(o=c.exec(e));){for(f=null,m=t.isDef(o[3])?o[3]:"",h=null,r.start=o.index,r.end=c.lastIndex,r.fullToken=o[1],null!==(s=d.exec(r.fullToken))&&(i=a.parseModelAttribName(s[1]),r.modelName=i[0],r.attribName=i[1]);null!==(f=t.RX_IDX_ITER.exec(o[3]));)p=t.isDef(f[1])?f[1]:f[2],r.indexQueue.push(p);for(;null!==(h=t.RX_ANNOT.exec(m));)switch(h[1]){case"mdl":r.repeatModelName=h[2];break;case"att":r.repeatAttribName=h[2];break;case"i":r.repeatIndex=h[2]}u.push(r),r=new l}return u},getRepeatToken:function(e){return this.getTokens(e,!0)},getAllTokens:function(e){return this.getTokens(e)},compile:function(e,l,d){if(t.isNull(e)||t.isNull(e.childNodes))return l;d=t.isInt(d)?parseInt(d):-1;var c=e.getAttribute("data-apl-default"),f=e.getAttribute("id"),p=s.blockBodyCompilation===!0&&f===t.MAIN_CONTENT_ID,m=e.childNodes,h=[],N=null,b=null,T=null,g=null,_=null,E=0,A="",v="",D="",y="",x=t.NO_COMPILE_ME;t.isNullOrEmpty(c)||p||(e.setAttribute("data-apl-default",""),r.asynGetPartial(c,u("Bootstrap").loadPartialIntoTemplate,null,e),t.log("Spawning Thread <"+c+"> w/ target <"+e.id+"> w/ scope <"+l+">"));for(var M=0;M<m.length;M++)if(g=m[M],T=g.parentNode,g.nodeType!==t.TEXT_NODE||t.isNull(T)||"OPTION"===T.tagName){if(g.nodeType===t.ELEMENT_NODE){var O,I=g.tagName.toLowerCase(),R=window.Templar._components[I],S=null,w=null,P=m.length,L=0;if(t.isDef(R)&&!t.isNullOrEmpty(R.templateContent)&&!t.isNull(g.parentNode)){if(g.insertAdjacentHTML("afterend",R.templateContent),L=m.length-P,S=g.nextElementSibling,S.scope=l,R.transclude===!0){var C;if(!t.isNullOrEmpty(C=S.getElementsByTagName("CONTENT"))){C=C[0];for(var k=0;k<g.childNodes.length;k++)t.isNull(C.parentNode)||C.parentNode.insertBefore(g.childNodes[k],C),k--;t.isNull(C.parentNode)||C.parentNode.removeChild(C)}}S.tmp_component=R,r.cloneAttributes(g,S,!0),w=a.preProcessNodeAttributes(S,l,d),t.isDef(S._setAttribute)?S._setAttributeWrapper=S.setAttribute:S._setAttribute=S.setAttribute,S.setAttribute=function(e,n){var i,r=this.tmp_component;t.isFunc(i=r.attributes[e])&&i.call(r,this,n),t.isDef(this._setAttributeWrapper)?this._setAttributeWrapper.call(this,e,n):this._setAttribute.call(this,e,n)};for(var Y=0;Y<w.length;Y++)w[Y].isComponent=!0,w[Y].componentName=I;R.onCreate.call(R,S),t.isNotNull(R.onChange)&&!function(e,t){t.addEventListener("DOMCharacterDataModified",function(n){e.onChange.call(e,t,n)})}(R,S),t.isNotNull(R.onDone)&&(R.onDone.node=S,R.onDone.context=R,window.Templar.done(R.onDone)),O=r.getDataAttribute(g,t.IE_MODEL_REPEAT_KEY),g.parentNode.removeChild(g),g=S,t.isNullOrEmpty(O)||g.setAttribute("data-"+t.IE_MODEL_REPEAT_KEY,O),M+=L}switch(O=r.getDataAttribute(g,t.IE_MODEL_REPEAT_KEY),!t.isNullOrEmpty(O)&&(h=this.getRepeatToken(O)).length>0&&r.annotateDOMNode(g,h[0].modelName,h[0].attribName,h[0]),x=a.preProcessNode(g,l,d)){case t.COMPILE_ME:this.compile(g,l,d);break;case t.NO_COMPILE_ME:break;case t.RECOMPILE_ME:M--}}}else{A=g.nodeValue,h=this.getTokens(A);for(var F=0;F<h.length&&(v=T.tagName,D=h[F].modelName,y=h[F].attribName,b=document.createElement("span"),_=new n(b,D,y),_.inheritToken(h[F]),_.scope=l,_.index=d,N=r.splitText(g,h[F].start-E),E+=g.nodeValue.length,N.nodeValue.trim()==h[F].fullToken&&(_.node.innerText=N.nodeValue,o.interpolateSpan(_),T.replaceChild(_.node,N),i.pushNodes(_)),g.nodeValue.trim()==h[F].fullToken&&(_.node.innerText=g.nodeValue,o.interpolateSpan(_),T.replaceChild(_.node,g),i.pushNodes(_)),g=m[++M],g.nodeType==t.TEXT_NODE)&&(N=r.splitText(g,h[F].end-E),E+=g.nodeValue.length,N.nodeValue.trim()==h[F].fullToken&&(_.node.innerText=N.nodeValue,o.interpolateSpan(_),T.replaceChild(_.node,N),i.pushNodes(_)),g.nodeValue.trim()==h[F].fullToken&&(_.node.innerText=g.nodeValue,o.interpolateSpan(_),T.replaceChild(_.node,g),i.pushNodes(_)),g=m[++M],g.nodeType==t.TEXT_NODE);F++);h.length=0,E=0}return l}}});window.structureJS.module("Link",function(e){"use strict";var t=this,n=e("Map"),i=e("Interpolate"),r=e("System"),o=e("State");return{bindModel:function(e){n.forEach(function(t){n.forEach(t.modelName,function(t){i.interpolate(t.modelName,t.modelAtrribName,n.getAttribute(t.modelName,t.modelAtrribName),e)})}),o.compiledScopes="",i.dispatchSystemListeners(t.SYSTEM_EVENT_TYPES.link_done),r.removeSystemListeners(t.SYSTEM_EVENT_TYPES.link_done)}}});window.structureJS.module("ModelAPI",function(e){"use strict";var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate"),o=window.structureJS.circular();n.prototype.update=function(e){var t=o("Compile").getTokens(this.modelName+"."+e,!0);t.length>0&&t[0].indexQueue.length>0?r.targetedInterpolate(t):r.interpolate(this.modelName,e,i.getAttribute(this.modelName,e))},n.prototype.listen=function(e,t){i.isDuplicateListener(this.modelName,e,t)||i.setListener(this.modelName,e,t)},n.prototype.onAssignment=function(e,n){this.listen(e,function(e){e.type==t.MODEL_EVENT_TYPES.reassignment&&n.call(null,e)})},n.prototype.onRepeatDone=function(e,n){var i=this;this.listen(e,function(r){r.type==t.SYSTEM_EVENT_TYPES.repeat_built&&r.modelName==i.modelName&&r.attribName==e&&n.call(n,r)})},n.prototype.unlisten=function(e,n){t.isFunc(n)?i.removeListener(this.modelName,e,n):t.isString(e)&&i.removeAllListeners(this.modelName,e)},n.prototype.save=function(){var e="",n=null;t.isDef(this.attributes.__meta__)||(this.attributes.__meta__={});for(var i in this.attributes)if(this.attributes.hasOwnProperty(i)&&t.isArray(n=this.attributes[i]))for(var r in n)n.hasOwnProperty(r)&&n.hasOwnProperty(r)&&!t.isInt(r)&&(t.isDef(this.attributes.__meta__[i])||(this.attributes.__meta__[i]={}),this.attributes.__meta__[i][r]=t.isString(n[r])?n[r]:JSON.stringify(n[r]));return e=JSON.stringify(this.attributes),delete this.attributes.__meta__,t.isDef(window.sessionStorage)&&(window.sessionStorage[this.modelName]=e),e},n.prototype.load=function(e){var n=null,i=!1,r=null,o=null,a=null;t.isDef(window.sessionStorage)&&!t.isDef(e)&&(e=window.sessionStorage[this.modelName],window.sessionStorage.removeItem(this.modelName));try{n=JSON.parse(e)}catch(s){i=!0}if(i===!0)return void t.log("ERROR: Frozen item was not proper JSON. Thaw failed.");for(var l in n)n.hasOwnProperty(l)&&"__meta__"!=l&&(this.attributes[l]=n[l]);if(t.isDef(r=n.__meta__))for(var u in r)if(r.hasOwnProperty(u)){o=r[u];for(var d in o)if(o.hasOwnProperty(d)&&t.isDef(this.attributes[u])){try{a=JSON.parse(o[d])}catch(s){a=o[d]}"_value_"==d&&(this.attributes[u].current_selection=a),this.attributes[u][d]=a}}return this.attributes}});window.structureJS.module("ModelFilter",function(e){"use strict";var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate");n.prototype.sort=function(e,n,o){var a={},s=this,l=t.isDef(s.limitTable[e])?s.limitTable[e].page:0,u=0,d=-1,c=1,p=0;return a.target=i.getAttribute(s.modelName,e),t.isDef(n)&&n>0&&t.isDef(s.limitTable[e])&&(l=s.limitTable[e].page,s.limitTable[e].page=n,a.target=i.getPageSlice(s,e,a.target)),a.propName=null,a.prevProps=[],a.insertSortedSlice=function(e,n,o,a){if(t.isDef(n.limitTable[o])){n.limitTable[o].page=t.isDef(a)?a:l,u=n.limitTable[o].limit,n.limitTable[o].limit=0;var s=n.attributes[o];n.limitTable[o].limit=u;var d=r.getPageSliceData(n,o,s),c=null;if(d.start>-1&&!t.isNull(e)){c=s.slice(0);for(var p=0,m=d.start;p<e.length&&m<d.length;p++,m++)c[m]=e[p];i.setAttribute(n.modelName,o,c.slice(0)),n.limitTable[o].page=l}}},a.arePastPropsAligned=function(e,t){for(var n=!0,i=0;i<a.prevProps.length;i++)n=n&&e[a.prevProps[i]]===t[a.prevProps[i]];return n},a.getSorter=function(e){var n=function(t,n){var i=e.call(null,t,n);return i=a.arePastPropsAligned(t,n)===!0?i:p};return t.isFunc(e)?n:a.sorter},a.sorter=function(e,n){var i=e,r=n,o=p,s=t.isNull(a.propName)?e:e[a.propName],l=t.isNull(a.propName)?n:n[a.propName];return t.isDef(s)&&t.isDef(l)?(o=l===s?p:s>l?c:d,o=a.arePastPropsAligned(i,r)===!0?o:p):p},a.orderBy=function(t,i){return a.propName=t,a.target.sort(a.getSorter(i)),a.insertSortedSlice(a.target,s,e,n),a.prevProps.push(t),a},a.thenBy=function(t,i){return a.propName=t,a.target.sort(a.getSorter(i)),a.insertSortedSlice(a.target,s,e,n),a.prevProps.push(t),a},a.target.sort(a.getSorter(o)),a.insertSortedSlice(a.target,s,e,n),a},n.prototype.sortCurrentPageOf=function(e){var n=this,i=n.limitTable[e];return t.isDef(i)?n.sort(e,i.currentPage):void 0}});window.structureJS.module("ModelFilter",function(e){"use strict";var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate");n.prototype.limit=function(e){var n={},r=this,o=0,a=0;return n.to=function(n){delete r.limitTable[e],o=i.getAttribute(r.modelName,e),t.isArray(o)&&n>=0&&(a=Math.floor(o.length/n),a+=o.length%n>0?1:0,r.limitTable[e]={limit:n,page:1,totalPages:a,currentPage:1},r.update(e))},n},n.prototype.gotoPage=function(e){var n={},o=this,a=null;return n.of=function(n){a=o.limitTable[n],t.isDef(a)&&e>0&&e<=a.totalPages&&(a.page=a.currentPage=e,r.interpolate(o.modelName,n,i.getAttribute(o.modelName,n)))},n},n.prototype.gotoNextPageOf=function(e){var n=this,i=n.limitTable[e];t.isDef(i)&&i.currentPage+1<=i.totalPages&&n.gotoPage(++i.currentPage).of(e)},n.prototype.gotoPreviousPageOf=function(e){var n=this,i=n.limitTable[e];t.isDef(i)&&i.currentPage-1>0&&n.gotoPage(--i.currentPage).of(e)},n.prototype.currentPageOf=function(e){var n=this,i=n.limitTable[e],r=0;return t.isDef(i)&&(r=i.currentPage),r},n.prototype.totalPagesOf=function(e){var n=this,i=n.limitTable[e],r=0;return t.isDef(i)&&(r=i.totalPages),r}});window.structureJS.module("ModelFilter",function(e){"use strict";var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate");n.prototype.filterWarapper=function(e,n,o,a,s,l,u){if(t.isDef(s)&&s===!0&&delete this.cachedResults[e],t.isDef(u)&&u===!0)return a.call(null,o)===!1?(t.isNullOrEmpty(o)&&r.interpolate(this.modelName,e,i.getAttribute(this.modelName,e)),!1):!0;var d=this,c=[],p=i.getAttribute(d.modelName,e),f=null,m=null,h=null;if(p=i.getPageSlice(d,e,p),t.isArray(p)){for(var N=0;N<p.length;N++)h=p[N],m=!t.isNullOrEmpty(n)&&t.isDef(h[n])?h[n]:h,f=l===!0?a.call(null,m):!t.isNullOrEmpty(o)&&a.call(null,o,m),f===!0&&c.push(h);c.length<1?(delete d.cachedResults[e],s===!0&&(c=i.getAttribute(d.modelName,e),r.interpolate(d.modelName,e,c))):(d.cachedResults[e]=c,t.isDef(l)&&l===!0&&(d.filterResults[e]=c),r.interpolate(d.modelName,e,c))}return!0},n.prototype.filter=function(e){var n={},r=this,o=!0,a=void 0,s=function(e,n){var i=!t.isNullOrEmpty(n)&&!t.isNullOrEmpty(e);return i&&0===n.toString().toLowerCase().indexOf(e.toLowerCase())};return n.propName="",n.isStatic=!1,n.liveAndFuncs=[],n.using=function(l){return t.isFunc(l)?(o=!1,a=!0,n.isStatic=!0,r.filterWarapper(e,n.propName,null,l,o,a)):(t.isDef(r.liveFilters[e])||(r.liveFilters[e]=[]),r.liveFilters[e].push(l),i.setListener(r.modelName,l,function(i){o=n.liveAndFuncs.length<1;for(var l=!0,u=!1,d=0;d<n.liveAndFuncs.length&&l===!0;d++){var c=1===n.liveAndFuncs[d].length;l=n.liveAndFuncs[d].funct.call(null,i.text,n.propName,c),u|=!c}t.log("overrideDefaultLiveFilter: "+u),l===!0&&u===!1&&r.filterWarapper(e,n.propName,i.text,s,o,a)},!0)),n},n.by=function(e){return n.propName=e,n},n.andBy=function(e){return n.propName=e,n},n.and=function(i){return t.isFunc(i)&&(n.liveAndFuncs.push({funct:function(t,s,l){return a=n.isStatic,o=!n.isStatic,r.filterWarapper(e,s,t,i,o,a,l)},length:i.length}),n.liveAndFuncs.sort(function(e){return 1!=e.funct.length}),o=!1,a=1===i.length,a===!0&&r.filterWarapper(e,n.propName,null,i,o,a)),n},n},n.prototype.resetLiveFiltersOf=function(e){var n=null;if(t.isDef(this.liveFilters[e])){n=this.liveFilters[e];for(var r=0;r<n.length;r++)i.removeFilterListeners(this.modelName,n[r])}},n.prototype.resetStaticFiltersOf=function(e){delete this.filterResults[e]}});window.structureJS.module("Route",function(e){"use strict";var t=this,n={},i=[],r=!1,o=function(){return!0},a=!1,l=function(){return!0},s=!1,u=function(){return!0},d=t.isDef(window.Storage)?sessionStorage:{},c=e("State"),f=e("DOM"),p=e("Map"),m=e("Interpolate"),h=e("Bootstrap");return{routeTree:{},buildRouteTree:function(e){for(var r={},o={},a=null,l="",s=null,u=null,d=!1,f=!1,p=null,m=null,h=null,N=null,g=null,b="",T="",_="",E=0;E<e.length;E++){i.push(e[E]),m=e[E].route.trim().split("/"),b=e[E].target,T=e[E].partial,_=e[E].fallback,s=r,u=o;for(var A=0;A<m.length;A++)if(""!==m[A]&&"#"!=m[A]){if(h=t.NT_REGEX.test(m[A])?t.NON_TERMINAL:t.TERMINAL,N=A+1<m.length?m[A+1]:null,g=t.isNull(N)?null:t.NT_REGEX.test(N)?t.NON_TERMINAL:t.TERMINAL,h==t.NON_TERMINAL&&g==t.NON_TERMINAL)throw"ERROR: Route Contains two consecutive variables.";l=h==t.NON_TERMINAL?m[A]:m[A].toLowerCase(),a=t.NT_REGEX.test(m[A])?"NT":l,t.isDef(s[l])||(s[l]={},s[l].endOfChain=!1,s[l].thisVal=l,s[l].thisType=h,d=!0),s[l].lookaheadVal=g==t.NON_TERMINAL?N:"",s[l].lookaheadType=g,t.isDef(u[a])||(u[a]={},f=!0),s=s[l],u=u[a],p=e[E].route}if(!d&&s.endOfChain===!0)throw'Error: Duplicate Route "'+e[E].route+'" Detected';if(!f)throw'Error: Ambiguous Route "'+e[E].route+'" Detected';s.endOfChain=!0,s.route=p,s.partial=t.isDef(T)?T:"",s.target=t.isDef(b)?b:"",s.fallback=t.isDef(_)?_:"",d=!1,f=!1}this.routeTree=n=r,c.hasDeclaredRoutes=!0},addRoute:function(e){i.push(e),this.buildRouteTree(i)},resolveRoute:function(e){for(var i=e.trim().split("/"),r=[],o="",a=n,l=0;l<i.length;l++)if(""!==i[l]&&"#"!=i[l]&&(t.isDef(a.lookaheadType)&&a.lookaheadType==t.NON_TERMINAL?(o=a.lookaheadVal,r.push([o,i[l]])):o=i[l].toLowerCase(),a=a[o],!t.isDef(a)))throw'Error: Route "'+e+'" not found';if(a.endOfChain!==!0)throw'Route "'+e+'" was only a partial match of declared routes.';return t.log("Route matched: "+e+" with "+a.route),a.nonTerminalValues=r,a},setAuthenticator:function(e){a===!1?(t.isFunc(e)&&(l=e),a=!0):t.log("ERROR: Authenticator already set")},setDeAuthenticator:function(e){s===!1?(t.isFunc(e)&&(u=e),a=!0):t.log("ERROR: DeAuthenticator already set")},setAuthorizer:function(e){r===!1?(t.isFunc(e)&&(o=e),r=!0):t.log("ERROR: Authenticator already set")},authorize:function(e){return o.call(d,e)},authenticate:function(e){return l.call(d,e)},logout:function(e){return u.call(d,e)},handleRoute:function(e){var n=f.getHashValue(e),i=null,r=null,o=null,a=this;if(c.hasDeclaredRoutes===!0)try{if(this.authorize.call(d,{route:n})!==!0)throw i=t.RESTRICTED,"User not authorized for url: "+e;i=a.resolveRoute(n),i.target=t.isNullOrEmpty(i.target)?t.MAIN_CONTENT_ID:i.target,r=i.nonTerminalValues;for(var l=0;l<r.length;l++)o=r[l][0].split(":"),p.setAttribute(o[0],o[1],r[l][1]),m.interpolate(o[0],o[1],r[l][1])}catch(s){t.log(s)}return i},open:function(e){var n=null;t.isNotNull(n=this.handleRoute(e))&&n!==t.RESTRICTED&&f.asynFetchRoutes(n,function(){c.ignoreHashChange=!0;var e,t=window.location.href;(e=t.indexOf("#"))>-1&&(t=window.location.href.slice(0,e)),window.location.href=t+n.route})},openPartial:function(e,n){n=t.isDef(n)?n:t.MAIN_CONTENT_ID,t.isNullOrEmpty(e)||f.asynGetPartial(e,h.loadPartialIntoTemplate,n)},isRoute:function(e){for(var t=!1,n=0;n<i.length;n++)i[n].route==e&&(t=!0);return t},getRouteObj:function(e){for(var t=null,n=0;n<i.length;n++)i[n].route==e&&(t=i[n]);return t},deferenceNestedRoutes:function(e,n){var i,r,o=null,a="";for(e=e.slice(0);t.isNotNull(o=e.shift());)(r=t.isString(o))&&(i=this.isRoute(o))?(a=this.getRouteObj(o),t.isArray(a.partial)?this.deferenceNestedRoutes(a.partial,n):n.push(a)):n.push(r?{partial:o,target:t.MAIN_CONTENT_ID}:o)}}});window.structureJS.module("Templar",function(e){"use strict";var t=this,n=e("Map"),i=e("Route"),r=e("ModelHeader"),o=e("System"),a=e("DOM"),s=e("Attribute"),l=e("Component"),u=function(){};return u._onloadHandlerMap={},u._components={},u._components.length=0,u._attributes={},u._attributes.length=0,u.addClass=function(e,t){a.modifyClasses(e,t,"")},u.removeClass=function(e,t){a.modifyClasses(e,"",t)},u.success=function(e,n){var i,r=!0;if(t.isDef(this._onloadHandlerMap[e])||(this._onloadHandlerMap[e]=[]),t.isFunc(n)){for(var a=0;a<this._onloadHandlerMap[e].length;a++)i=this._onloadHandlerMap[e][a],r=r&&i.toString()!=n.toString();r===!0&&this._onloadHandlerMap[e].push(n)}t.isFunc(e)&&o.setSystemListeners(t.SYSTEM_EVENT_TYPES.framework_loaded,function(){e.call(null)})},u.getPartialOnlodHandler=function(e){var n=[];return t.isDef(this._onloadHandlerMap[e])&&(n=this._onloadHandlerMap[e]),n},u.getModel=function(e){return n.getModel(e)},u.dataModel=function(e,t){n.initModel(new r(e,t))},u.Route=function(e){i.buildRouteTree(e)},u.setAuthorizer=function(e){i.setAuthorizer(e)},u.setAuthenticator=function(e){i.setAuthenticator(e)},u.setDeAuthenticator=function(e){i.setDeAuthenticator(e)},u.done=function(e){o.setSystemListeners(t.SYSTEM_EVENT_TYPES.link_done,e)},u.attribute=function(e,n){if(t.isString(e)&&t.isDef(n)){var i=new s(e.toLowerCase()),r=function(){},o=function(){};for(var a in n)if(n.hasOwnProperty(a))switch(a){case"onCreate":r=n.onCreate,i.onCreate=r=t.isFunc(r)?r:function(){};break;case"onChange":o=n.onCreate,i.onChange=o=t.isFunc(o)?o:function(){}}i.onCreate=function(e){i.onChange.call(i,e,e.getAttribute(i.name)),r.call(i,e)},u._attributes[i.name]=i}},u.component=function(e,n){if(t.isString(e)&&t.isDef(n)){var i=new l;for(var r in n)if(n.hasOwnProperty(r))switch(r){case"templateURL":i.templateURL=n.templateURL,t.isNullOrEmpty(i.templateURL)&&t.log('WARNING: Component declaration for "'+e+'" ignored. Declaration must have a URL.');break;case"attributes":var o=n.attributes;try{i.attributes=t.isObject(o)?o:{};for(var a in i.attributes)i.attributes.hasOwnProperty(a)&&(i.attributes[a]=t.isFunc(i.attributes[a])?i.attributes[a]:function(){})}catch(s){t.log('Component "attributes" is not an object'),i.attributes={}}break;case"onCreate":var d=n.onCreate;i.onCreate=t.isFunc(d)?d:function(){};break;case"onDone":i.onDone=t.isFunc(n.onDone)?n.onDone:null;break;case"onChange":i.onChange=t.isFunc(n.onChange)?n.onChange:null;break;case"onDestroy":i.onDestroy=t.isFunc(n.onDestroy)?n.onChange:function(){};break;default:i[r]=n[r]}t.isNullOrEmpty(i.templateURL)||t.isDef(u._components[e.toLowerCase()])?t.log('WARNING: Component "'+e+'" is declared more than once. Only the last declaration will be used.'):(u._components[e.toLowerCase()]=i,u._components.length++)}},u.RouteObj=i,u.Map=n,window.Templar=u,u});window.structureJS.module("Bootstrap",function(e){"use strict";var t=this,n=e("Map"),i=e("Link"),r=e("State"),o=e("Compile"),a=e("Route"),l={fireOnloads:function(e){for(var n="",i=null,o=e.split(","),a=!1,l=0;l<r.onloadFileQueue.length;l++){n=r.onloadFileQueue[l];for(var s=0;s<o.length;s++)a=a||o[s]==n;if(a===!0){n=r.onloadFileQueue.splice(l,1),i=window.Templar.getPartialOnlodHandler(n),t.log("Firing "+i.length+" handlers(s) for: "+n);for(var u=0;u<i.length;u++)i[u].call(null);l--}}t.log("Un-Fired on queue: "+r.onloadFileQueue.toString())},loadPartialIntoTemplate:function(){if(200==this.status){var e=this.responseText,s=this.fileName,u=t.isNullOrEmpty(this.targetId)?t.MAIN_CONTENT_ID:this.targetId.replace("#",""),d=t.isNotNull(this.targetNode)?this.targetNode:document.getElementById(u),c=(new Date).getTime(),f=s+" "+c,p=this.callback||function(){};t.isNull(d)?(t.log('WARNING: TARGET NODE NOT FOUND FOR ROUTE "'+this.route+'".'),t.isNullOrEmpty(this.fallback)||(t.log('WARNING: ATTEMPTING FALLBACK ROUTE "'+this.fallback+'".'),a.open(this.fallback))):(d.innerHTML=e,t.log("Compiling <"+s+"> w/ scope <"+f+">"),r.compiledScopes+=f+",",o.compile(d,f),r.onloadFileQueue.unshift(this.fileName),p.call(this),r.compilationThreadCount<=0&&(n.pruneNodeTreeByScope(r.compiledScopes),i.bindModel(r.compiledScopes),l.fireOnloads(this.fileName),r.compilationThreadCount=0))}}};return l});window.structureJS.module("Export",function(e){"use strict";function t(e){d.dispatchSystemListeners(i.SYSTEM_EVENT_TYPES.framework_loaded),c.removeSystemListeners(i.SYSTEM_EVENT_TYPES.framework_loaded),i.log("Running bootstrap Complete: "+e)}function n(e){var n=null,l=null,d=null;o.compiledScopes+=e+",",i.isNotNull(n=s.handleRoute(window.location.href))&&(i.isNullOrEmpty(n.partial)||(l=document.getElementById(n.target),d=r.getDataAttribute(l,i.IE_DEFAULT_ATTRIB_KEY),i.isNull(l)||i.isNullOrEmpty(d)||l.setAttribute("data-"+i.IE_DEFAULT_ATTRIB_KEY,""),r.asynFetchRoutes(n,function(){i.log("asynFetchRoutes complete for "+n.route),t("ASYN FETCH ROUTES")}),o.blockBodyCompilation=!0)),o.blockBodyCompilation===!1?(a.compile(document.getElementsByTagName("body")[0],e),u.bindModel(o.compiledScopes),t("BODY COMPILATION")):i.log("WARNING: Body compilation has been blocked")}var i=this,r=e("DOM"),o=e("State"),a=(e("Bootstrap"),e("Compile")),l=e("Templar"),s=e("Route"),u=e("Link"),d=e("Interpolate"),c=e("System");window.structureJS.done(function(){"undefined"==typeof window.console&&(window.console={log:function(){}});var e="body "+(new Date).getTime();window.onhashchange=function(){var e=null;return o.ignoreHashChange===!0?void(o.ignoreHashChange=!1):void(i.isNotNull(e=s.handleRoute(window.location.href))&&r.asynFetchRoutes(e,function(){i.log("asynFetchRoutes complete for "+e.route)}))};var t=l._components.length,a=function(){var t=this.targetNode,i=document.createElement("div"),r=i.getElementsByTagName("style"),a=document.getElementsByTagName("head")[0];o.compilationThreadCount--,i.innerHTML=this.responseText,t.transclude=i.getElementsByTagName("content").length>0;for(var s=0;s<r.length;s++)0===s?a.appendChild(r[s]):i.removeChild(r[s]);t.templateContent=i.innerHTML,--l._components.length<1&&n(e)};for(var u in l._components)if(l._components.hasOwnProperty(u)&&"length"!==u){var d=l._components[u];i.isNullOrEmpty(d.templateURL)||r.asynGetPartial(d.templateURL,a,"",d)}1>t&&n(e)})});