structureJS.module("Constants",function(){_=Object.create(null),_.MODEL_ATTRIB_KEY="aplAttrib",_.MODEL_ATTRIB_REPEAT_KEY="aplRepeat",_.TARGET_ATTRIB_KEY="aplTarget",_.CTRL_KEY="aplControl",_.CTRL_ATTRIB_STRING="data-apl-control",_.IE_MODEL_ATTRIB_KEY="apl-attrib",_.IE_MODEL_REPEAT_KEY="apl-repeat",_.IE_TARGET_ATTRIB_KEY="apl-target",_.IE_CTRL_ATTRIB_KEY="apl-control",_.IE_DEFAULT_ATTRIB_KEY="apl-default",_.CLASS_SEPARATOR=/,|\s/,_.NT_REGEX=/\w\:\w/,_.TEXT_NODE=3,_.ELEMENT_NODE=1,_.UNINDEXED=-1,_.NON_TERMINAL=0,_.TERMINAL=1,_.STACK=0,_.QUEUE=1,_.SYSTEM_EVENT_TYPES={system:"TMP_SYSTEM",interpolation_done:"interp_done",repeat_built:"repeat_built",LIST_TYPE:_.QUEUE},_.MODEL_EVENT_TYPES={interp_change:"i_change",select_change:"s_change"},structureJS.extendContext(_)});structureJS.module("Util",function(){_=Object.create(null),_.isDef=function(_){return"undefined"!=typeof _},_.isString=function(t){return!_.isDef(t)||"string"==typeof t},_.isFunc=function(t){return!_.isDef(t)||"function"==typeof t},_.isNull=function(t){return!_.isDef(t)||null==t},_.isNullOrEmpty=function(t){return!_.isDef(t)||null===t||""===t},_.isArray=function(t){return!_.isNull(t)&&"string"!=typeof t&&_.isDef(t.length)},_.log=function(_){console.log(_)},structureJS.extendContext(_)});structureJS.module("TMP_Node",function(){var t=this,e=function(_,n,i,r){return this instanceof e?(this.node=_,this.modelName=n,this.attribName=i,this.index=t.isDef(r)?r:-1,this.prop="",this.symbolMap=Object.create(null),this.hasNonTerminals=!1,this.embeddedControls=[],this.embeddedModelAttribs=Object.create(null),this.scope="",this.hasAttributes=!1,this.repeatModelName="",this.repeatAttribName="",void(this.repeatIndex=t.UNINDEXED)):new e(_,id,n,i,r)};return e});structureJS.module("ControlNodeHeader",function(){var t=this,e=function(i,n,s,_,r){if(!(this instanceof e))return new e(i,n,s,_,r);var l=null;if(this.node=t.isDef(i)?i:null,this.id=t.isDef(n)?n:"",this.modelName=t.isDef(s)?s:"",this.attribName=t.isDef(_)?_:"",this.index=t.isDef(r)?r:-1,this.scope="",this.childIds=Object.create(null),this.controlBaseNodes=[],!t.isNull(this.node))for(var o=0;o<this.node.children.length;o++)t.isNullOrEmpty(this.node.children[o].id)||(l=new e(this.node.children[o]),l.controlBaseNodes.push(l),this.childIds[this.node.children[o].id]=l)};return e});structureJS.module("ModelHeader",function(){var e=this,t=structureJS.circular(),i=function(n,s){if(!(this instanceof i))return new i(s);this.modelName=n;for(var r in s)s.hasOwnProperty(r)&&Object.defineProperty(this,r,{set:function(i,n){return function(s){e.log("SET FIRED for "+n.modelName+"."+i),e.isDef(n.limitTable[i])&&delete n.limitTable[i],e.isDef(n.filterResults[i])&&delete n.filterResults[i],e.isDef(n.cachedResults[i])&&delete n.cachedResults[i],t("Map").setAttribute(n.modelName,i,s),t("Interpolate").interpolate(n.modelName,i,s)}}(r,this),get:function(e,t){return function(){return Map.getAttribute(t.modelName,e)}}(r,this)});this.attributes=s,this.cachedResults=Object.create(null),this.filterResults=Object.create(null),this.limitTable=Object.create(null),this.liveFilters=Object.create(null)};return i});structureJS.module("DOM",function(){return{modifyClasses:function(t,e,i){var n="",s=i.split(_.CLASS_SEPARATOR);if(!_.isNull(t)){n=t.getAttribute("class"),n=_.isNull(n)?"":n.trim();for(var r=0;r<s.length;r++)n=n.replace(s[r],"","g");t.setAttribute("class",n+" "+e)}},hideByIdList:function(t){var e=null,i=null;if(null!=t&&""!=t){i=t.split(_.CLASS_SEPARATOR);for(var n=0;n<i.length;n++)e=document.getElementById(i[n]),this.modifyClasses(e,"apl-hide","apl-show,apl-hide")}},appendTo:function(t,e){_.isDef(e)&&_.isDef(t)&&!_.isNull(e.parentNode)&&e.parentNode.insertBefore(t,t.nextSibling)},cloneAttributes:function(t,e){if(t.hasAttributes()){attributes=t.attributes;for(var i=0;i<attributes.length;i++)"data-apl-repeat"!=attributes[i].name&&"style"!=attributes[i].name&&e.setAttribute(attributes[i].name,attributes[i].value)}},isVisible:function(t){return _.isNull(t)?!1:t.offsetWidth>0&&t.offsetHeight>0},asynGetPartial:function(t,e,i,n){var s=new XMLHttpRequest;s.onload=e,s.fileName=t,s.targetId=i,s.targetNode=n,s.onreadystatechange=function(){4===s.readyState&&200!==s.status},_.isNullOrEmpty(s.fileName)||(s.open("get",t,!0),s.send())},insertAfter:function(t,e){var i=e.nextSibling,n=e.parentNode;return i?n.insertBefore(t,i):n.appendChild(t),t},splitText:function(t,e){var i=t.cloneNode(!1);return i.deleteData(0,e),t.deleteData(e,t.length-e),this.insertAfter(i,t),i},getHashValue:function(t){return _.isString(t)?t.substring(t.indexOf("#")).replace("#",""):""},getDataAttribute:function(t,e){var i=_.isString(e)?e.split("-"):[],n=null,s=i.slice(0,1).concat(i.slice(1).map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)})).join("");return _.isNull(t)||(n=_.isDef(t.dataset)?t.dataset[s]:t.getAttribute("data-"+e)),_.isNull(n)?"":n}}});structureJS.module("State",function(){return{preventUpdate:!1,target:"",aplHideList:"",compilationThreadCount:0,onloadFileQueue:[],hasDeclaredRoutes:!1,compiledScopes:""}});structureJS.module("Map",function(e){var t=this,i=Object.create(null),n=Object.create(null),r=Object.create(null);r[t.SYSTEM_EVENT_TYPES.system]=Object.create(null),r[t.SYSTEM_EVENT_TYPES.system].listeners=Object.create(null);var l=e("TMP_Node");return{buildAttribAlias:function(e){return"_"+e},getRepeatBaseNodes:function(e,n){var r=[];return t.isDef(n)&&t.isDef(e)&&t.isDef(i[e])&&t.isDef(i[e][n])&&(r=i[e][n]),r},addRepeatBaseNode:function(e){t.isDef(i[e.modelName])||(i[e.modelName]=Object.create(null)),t.isDef(i[e.modelName][e.attribName])||(i[e.modelName][e.attribName]=[]),i[e.modelName][e.attribName].push(e)},addControlNode:function(e){t.isDef(n[e.id])||(n[e.id]=[]),n[e.id].push(e)},exists:function(e){return t.isDef(r[e])},contains:function(e,i){if(!t.isArray(e))return!1;for(var n=!1,r=0;r<e.length;r++)if(e[r]===i){n=!0;break}return n},isInScopeList:function(e,i,n){var r=null,l=t.isDef(e)?e.split(" "):[],i=t.isDef(i)?i.split(","):[],n=t.isDef(n)?n:!1;if(inScope=!1,i.length>0){l=l.length>1?l:[null,null],r=i.map(function(e){var t=e.split(" ");return t.length>1?t:[null,null]});for(var s=0;s<r.length;s++)if(!t.isNullOrEmpty(l[0])&&!t.isNullOrEmpty(r[s][0])&&l[0]==r[s][0]){inScope=1==n?!0&&l[1]==r[s][1]:!0;break}}return inScope},Control:{forEach:function(e){var i=null;if(t.isFunc(e)){var r=null,l=Object.create(null);l.index=0,l.id="",l.length=0,l.stop=!1,l.target=[],l.removeItem=function(e){this.target.splice(e,1),this.length=this.target.length};for(var s in n){r=l.target=n[s],l.length=r.length,l.id=s;for(var a=0;a<r.length&&(l.index=a,i=r[a],e.call(null,l,i),1!=l.stop);a++);}}}},forEach:function(e,i,n){var l=null,s=Object.create(null);if(s.modelName="",s.modelAtrribName="",s.hasAttributes=!1,s.stop=!1,s.target=null,s.targetCopy=null,s.key="",s.length=0,s.index=0,s.modelAttribIndex=0,s.modelAttribLength=0,s.removeItem=function(e){s.target.splice(e,1);for(var i=Object.create(null),e=0;e<s.target.length;e++)s.target[e].index>t.UNINDEXED&&(i[s.target[e].index]=!0);s.modelAttribLength=Object.keys(i).length,s.index--},t.isFunc(e)){n=e,l=r;for(var a in l)n.call(null,{modelName:a},a)}else if(!t.isFunc(e)&&t.isFunc(i)){n=i;l=t.isDef(r[e])&&t.isDef(r[e].nodeTable)?r[e].nodeTable:Object.create(null);for(var a in l)s.modelName=e,s.modelAtrribName=a,n.call(null,s,a)}else if(!t.isFunc(e)&&!t.isFunc(i)&&t.isFunc(n)){var o=null,u=Object.create(null);if(t.isDef(r[e].nodeTable[i])){s.target=r[e].nodeTable[i].nodes;for(var c=0;c<s.target.length;c++)s.target[c].index>t.UNINDEXED&&(u[s.target[c].index]=!0);for(s.modelAttribLength=Object.keys(u).length;s.index<s.target.length&&0==s.stop;s.index++)o=s.target[s.index],s.modelName=e,s.modelAtrribName=i,s.modelAttribIndex=o.index,s.key=a,s.hasAttributes=Object.keys(s.target[s.index].symbolMap).length>0?!0:!1,n.call(null,s,o)}}},pushNodes:function(e,i,n,s){var a=e;a instanceof l||(a=new l(e,i,n,s)),t.isDef(r[a.modelName].nodeTable[a.attribName])||(r[a.modelName].nodeTable[a.attribName]={nodes:[]}),r[a.modelName].nodeTable[a.attribName].nodes.push(a)},getPageSlice:function(e,i,n){var r=0,l=n.length,s=0,a=0,o=n;return t.isDef(e.limitTable[i])&&t.isArray(n)&&(a=e.limitTable[i].page,s=e.limitTable[i].limit,l=s*a<=n.length?s*a:n.length,r=l>a*s-s?a*s-s:0,o=n.slice(r,l)),o},getAttribute:function(e,i,n,l){var s=null,a=r[e].api;return t.isDef(r[e])&&t.isDef(r[e].modelObj[i])&&(s=r[e].modelObj[i]),t.isDef(r[e].filterResults[i])&&(s=r[e].filterResults[i]),t.isDef(a.limitTable[i])&&a.limitTable[i].limit>0&&(s=this.getPageSlice(a,i,s)),t.isDef(r[e].cachedResults[i])&&(s=r[e].cachedResults[i]),t.isDef(n)&&t.isDef(l)&&t.isArray(s)&&t.isDef(s[n][l])?s=s[n][l]:t.isDef(n)&&t.isArray(s[n])&&t.isDef(s[n])&&(s=s[n]),s},setAttribute:function(e,i,n){var l=null;return t.isDef(r[e])&&t.isDef(r[e].modelObj[i])&&(r[e].modelObj[i]=n),l},getListeners:function(e,i){var n=[];return t.isDef(r[e].listeners[i])&&(n=r[e].listeners[i]),n},setListener:function(e,i,n,l){if(t.isFunc(n)){var s=n.toString(),a=s.length+s.charAt(s.length/2);t.isDef(l)&&1==l&&(a="_LIVE_FILTER_"+a+Math.random(),t.log("Adding duplicate with id "+a+" on "+e+"."+i)),t.isDef(r[e].listeners[i])||(r[e].listeners[i]=Object.create(null)),r[e].listeners[i][a]=n}},removeListener:function(e,t){delete r[e].listeners[t]},isDuplicateListener:function(e,t,i){var n=this.getListeners(e,t);for(var r in n)if(i.toString()==n[r].toString())return!0;return!1},removeFilterListeners:function(e,i){if(t.isDef(r[e].listeners[i])){var n=r[e].listeners[i];for(var l in n)0==l.indexOf("_LIVE_FILTER_")&&(t.log("REMOVING Listener with id: "+l),delete n[l])}},getModel:function(e){var t=null;return this.exists(e)&&(t=r[e].api),t},initModel:function(e){r[e.modelName]={modelObj:e.attributes,nodeTable:Object.create(null),api:e,listeners:Object.create(null),cachedResults:e.cachedResults,limitTable:e.limitTable,filterResults:e.filterResults}},pruneControlNodesByIndex:function(e,i,n,r){var l=this,s=e.scope.split(" "),a=null;l.Control.forEach(function(e,l){a=l.scope.split(" "),a[0]==s[0]&&a[1]==s[1]&&l.index==r&&l.modelName==i&&l.attribName==n&&(t.log("Pruning Controll Node "+l.node.tagName+" scope: "+a[0]+" "+a[1]),e.removeItem(e.index))})},pruneControlNodesByScope:function(e,i,n,r){var l=this,s=null;l.Control.forEach(function(a,o){s=o.scope.split(" "),!l.isInScopeList(o.scope,r)||l.isInScopeList(o.scope,r,!0)||o.index!=n||o.modelName!=e&&!t.isNullOrEmpty(o.modelName)||o.attribName!=i&&!t.isNullOrEmpty(o.attribName)||(t.log("Pruning Controll Node "+o.node.tagName+" scope: "+s[0]+" "+s[1]),a.removeItem(a.index))})},pruneEmbeddedNodes:function(e,i,n,r){for(var l=this,s=Object.keys(e.embeddedModelAttribs),a=null,o=0;o<s.length;o++)t.isNullOrEmpty(s[o])||(a=s[o].split("."),l.forEach(a[0],a[1],function(e,l){l.repeatModelName==i&&l.repeatAttribName==n&&l.repeatIndex==r&&(e.removeItem(e.index),t.log("Pruning Embedded :"+l.node.tagName))}))},pruneNodeTreeByScope:function(e){if(!t.isNullOrEmpty(e)){var i=null,n=this;n.forEach(function(r){n.forEach(r.modelName,function(r){n.forEach(r.modelName,r.modelAtrribName,function(r,l){var s=l.node,a=l.index;null!==(i=l.scope.split(" "))&&n.isInScopeList(l.scope,e)&&!n.isInScopeList(l.scope,e,!0)&&(r.removeItem(r.index),n.pruneControlNodesByScope(r.modelName,r.modelAtrribName,a,e),t.log("Pruning "+s.tagName+" for "+r.modelName+"."+r.modelAtrribName+" scope: "+i[0]+" "+i[1]))})})})}},getInternalModel:function(e){return results=null,this.exists(e)&&(results=r[e]),results},getMap:function(){return r},getControls:function(){return n},getRepeat:function(){return i},getBaseControls:function(e){return t.isDef(n[e])?n[e]:null}}});structureJS.module("System",function(e){var t=this,i=e("Map");return{setSystemListeners:function(e,n){var r=t.SYSTEM_EVENT_TYPES.system,l=i.getMap(),s=l[r].listeners[r];t.isFunc(n)&&(t.isDef(s)||(s=l[r].listeners[r]=Object.create(null)),t.isDef(s[e])||(s[e]=[]),s[e].push(n))},getSystemListeners:function(e){var n=t.SYSTEM_EVENT_TYPES.system,r=i.getMap(),l=r[n].listeners[n],s=[];return t.isNullOrEmpty(e)||t.isDef(l)&&t.isDef(l[e])&&(s=l[e]),s},removeSystemListeners:function(e){var n=t.SYSTEM_EVENT_TYPES.system,r=i.getMap(),l=r[n].listeners[n];t.isNullOrEmpty(e)||t.isDef(l)&&t.isDef(l[e])&&delete l[e]}}});structureJS.module("Process",function(e){var t=this,n=e("TMP_Node"),i=e("Map"),r=e("DOM");return{CONTROL_REGEX:new RegExp(t.CTRL_ATTRIB_STRING+'="(\\w+)"',"g"),parseModelAttribName:function(e){var n=["",""];return t.isDef(e)&&(n=e.split(".")).length>1,n},buildNonTerminal:function(e,n,i,r){var i=t.isNullOrEmpty(i)?"":"."+i;return"{{"+e+"."+n+"["+r+"]"+i+"}}"},buildControlNonTerminal:function(e,n,i,r){return r=t.isDef(r)?"."+r:"","|"+e+"."+n+r},buildRepeatNonTerminal:function(e,n,i,r,l){var a=t.isNullOrEmpty(a)?"":a;return"{{"+e+"."+n+"["+l+"].zTMPzDOT"+i+"DOT"+r+"}}"},preProcessNodeAttributes:function(e,t){var r=null,l=null,a=/\{\{(\w+)\.(\w+)(\[(\d+)\])*(?:\.)*(\w+)*?\}\}/g,s=null;if(e.hasAttributes()&&"OPTION"!=e.tagName){r=e.attributes;for(var o=0;o<r.length;o++)if("style"!=r[o].name&&"class"!=r[o].name)for(;null!=(l=a.exec(r[o].value));)s=new n(e,l[1],l[2]),s.symbolMap[r[o].name]=r[o].value,s.scope=t,hasAttribNonTerminal=!0,i.pushNodes(s),Interpolate.updateNodeAttributes(s,s.modelName,s.attribName)}},preProcessControl:function(e){for(var n=e.node.innerHTML,i=null,r="";null!=(i=new RegExp(t.CTRL_ATTRIB_STRING+'="(\\w+)"',"g").exec(e.node.innerHTML.trim()))&&!t.isNullOrEmpty(e.modelName)&&!t.isNullOrEmpty(e.attribName);)e.embeddedControls.push(i[1]),r=t.CTRL_ATTRIB_STRING+'="'+i[1]+this.buildControlNonTerminal(e.modelName,e.attribName,i[1],e.index)+'"',e.node.innerHTML=n=n.replace(i[0],r)},preProcessRepeatNode:function(e,t){var i=null,l=null,a=null,s="",s="";if(intraCompilation="",idvRepeatedProperty=null,nonTerminal="",newDomNode=document.createElement(e.node.tagName.toLowerCase()),TMP_repeatedNode=new n(newDomNode,e.modelName,e.attribName,t),ctrlRegexResults=null,NONTERMINAL_REGEX=/(\{\{((\w+)\.(\w+))\}\})/g,ntFound=!1,Process=this,r.cloneAttributes(e.node,TMP_repeatedNode.node),TMP_repeatedNode.node.innerHTML=e.node.innerHTML,i=e.node.getAttribute("id"),i=null==i?"":TMP_repeatedNode.node.setAttribute("id",i+"-"+t),intraCompilation=TMP_repeatedNode.node.innerHTML,null!=(a=NONTERMINAL_REGEX.exec(TMP_repeatedNode.node.innerHTML))&&(e.embeddedModelAttribs[a[3]+"."+a[4]]=!0,nonTerminal=this.buildRepeatNonTerminal(a[3],a[4],e.modelName,e.attribName,t),TMP_repeatedNode.node.innerHTML=intraCompilation=intraCompilation.replace(a[0],nonTerminal)),null!=(l=TMP_repeatedNode.node.innerHTML.match(/\{\{(\$*\w+)*\}\}/g))){TMP_repeatedNode.hasNonTerminals=!0,s=intraCompilation=TMP_repeatedNode.node.innerHTML;for(var o=0;o<l.length;o++)(idvRepeatedProperty=/\{\{(\$*\w+)*\}\}/.exec(l[o]))&&("{{}}"==idvRepeatedProperty[0]&&(nonTerminal=this.buildNonTerminal(e.modelName,e.attribName,null,t),TMP_repeatedNode.node.innerHTML=intraCompilation=intraCompilation.replace(idvRepeatedProperty[0],nonTerminal)),"{{$index}}"==idvRepeatedProperty[0]&&(TMP_repeatedNode.node.innerHTML=intraCompilation=intraCompilation.replace(idvRepeatedProperty[0],t)),"{{}}"!=idvRepeatedProperty[0]&&"{{$index}}"!=idvRepeatedProperty[0]&&(nonTerminal=this.buildNonTerminal(e.modelName,e.attribName,idvRepeatedProperty[1],t),TMP_repeatedNode.node.innerHTML=intraCompilation=intraCompilation.replace(idvRepeatedProperty[0],nonTerminal)));intraCompilation=s}return TMP_repeatedNode.hasNonTerminals=0==TMP_repeatedNode.hasNonTerminals?!_isNullOrEmpty(TMP_repeatedNode.node.innerHTML):TMP_repeatedNode.hasNonTerminals,this.preProcessControl(TMP_repeatedNode),TMP_repeatedNode},preProcessNode:function(e,l,a,s){if(t.isDef(e)&&null!==e){var o=r.getDataAttribute(e,t.IE_MODEL_REPEAT_KEY),u=t.isNullOrEmpty(o)?e.tagName:"REPEAT",d=null,c=/(\{\{(\w+\.\w+)\}\})/g,m=null,p=null,f=null,N=null,h=null,T=null,b=!0,_=this;switch(u){case"SELECT":if(null===(m=c.exec(e.innerHTML)))break;if(e.innerHTML="",p=_.parseModelAttribName(m[2]),d=i.getAttribute(p[0],p[1]),e.model=p[0],e.name=p[1],N=new n(e,p[0],p[1]),N.scope=s,i.pushNodes(N),e.children.length<1)for(var g=0;g<d.length;g++)h=new n(document.createElement("option"),p[0],p[1],g),h.scope=s,h.node.text=_.buildNonTerminal(p[0],p[1],"text",g),h.node.value=_.buildNonTerminal(p[0],p[1],"value",g),e.appendChild(h.node),e.selectedIndex=t.isDef(d[g].selected)&&1==d[g].selected?g:e.selectedIndex,i.pushNodes(h);e.addEventListener("change",function(e){Interpolate.dispatchListeners(i.getListeners(this.model,this.name),{type:t.MODEL_EVENT_TYPES.select_change,value:e.target.options[e.target.selectedIndex].value,text:e.target.options[e.target.selectedIndex].text,index:e.target.selectedIndex})});break;case"INPUT":null!==(m=c.exec(e.getAttribute("value")))&&(p=_.parseModelAttribName(m[2]),e.model=p[0],e.name=p[1],e.addEventListener("keyup",function(e){i.setAttribute(this.model,this.name,e.target.value),Interpolate.interpolate(this.model,this.name,e.target.value)}));break;case"REPEAT":d=i.getAttribute(l,a),e.model=l,e.name=a,f=new n(e,l,a),f.scope=s,i.addRepeatBaseNode(f),i.pushNodes(f),b=!1;break;default:T=new n(e,l,a),this.preProcessControl(T)}return this.preProcessNodeAttributes(e,s),b}}}});structureJS.module("Interpolate",function(e){var t=this,n=e("TMP_Node"),i=e("Map"),r=e("DOM"),l=e("Process"),a=e("System"),o=structureJS.circular();return{dispatchListeners:function(e,n){if(t.isDef(e))for(var i in e)t.isFunc(e[i])&&e[i].call(null,n)},dispatchSystemListeners:function(e){if(!t.isNullOrEmpty(e)){{var n=a.getSystemListeners(e);t.SYSTEM_EVENT_TYPES.system}if(t.SYSTEM_EVENT_TYPES.LIST_TYPE==t.QUEUE)for(var i=0;i<n.length;i++)t.isFunc(n[i])&&n[i].call(null);else if(t.SYSTEM_EVENT_TYPES.LIST_TYPE==t.STACK)for(var i=n.length-1;i>=0;i--)t.isFunc(n[i])&&n[i].call(null)}},updateNodeAttributes:function(e){var n=Object.create(null),r=e.node;if(r.hasAttributes())for(var a=/(\{\{(\w+\.\w+)(\[(\d+)\])*(?:\.)*(\w+)*?\}\})/g,o=null,s="",d="",u="",c="",p=r.attributes,m=0;m<p.length;m++)if(u=p[m].name,d=t.isDef(e.symbolMap[u])?e.symbolMap[u]:"",t.isDef(d)&&a.test(d)){for(a.lastIndex=0;null!=(o=a.exec(d));)modelNameParts=l.parseModelAttribName(o[2]),c=i.getAttribute(modelNameParts[0],modelNameParts[1],o[4],o[5]),s=d.replace(o[1],c),d=s;r.setAttribute(u,s),n[u]=s}return n},interpolateSpan:function(e,n){var i=e.node;t.isNullOrEmpty(e.prop)&&e.index>=0&&t.isDef(n[e.index])&&e.index<n.length?i.innerText=i.innerHTML=n[e.index]:t.isNullOrEmpty(e.prop)&&e.index==t.UNINDEXED?i.innerText=i.innerHTML=n:!t.isNullOrEmpty(e.prop)&&e.index>=0&&t.isDef(n[e.index])&&e.index<n.length&&(i.innerText=i.innerHTML=n[e.index][e.prop])},getPageSlice:function(e,n,i){var r=0,l=i.length,a=0,o=0,s=i;return t.isDef(e.limitTable[n])&&(o=e.limitTable[n].page,a=e.limitTable[n].limit,l=a*o<=i.length?a*o:i.length,r=l>o*a-a?o*a-a:0,s=i.slice(r,l)),s},getPageSliceData:function(e,n,i){var r=0,l=i.length,a=0,o=0,s=Object.create(null);return s.start=-1,s.length=0,t.isDef(e.limitTable[n])&&(o=e.limitTable[n].page,a=e.limitTable[n].limit,l=a*o<=i.length?a*o:i.length,r=l>o*a-a?o*a-a:0,s.start=r,s.length=l),s},interpolate:function(e,s,d,u){if(i.exists(e)){t.log("Attemping Interpolation "+e+"."+s+" for scopes "+u);listeners=i.getListeners(e,s),Interpolate=this,attribCurrState=i.getAttribute(e,s),updateObject=Object.create(null),numNodesToAdd=0,numNodesToRemove=0,newNodeStartIndex=0,TMP_repeatBaseNode=null,updateObj=Object.create(null),nodeScopeParts=null,node=null,i.forEach(e,s,function(c,p){if(t.isDef(u)&&!i.isInScopeList(p.scope,u))return void t.log("Not Interpolating "+e+"."+s+" for scope <"+p.scope+"> not in <"+u+">");switch(node=p.node,1==c.hasAttributes&&(updateObject=Interpolate.updateNodeAttributes(p,e,s)),node.tagName){case"SELECT":if(t.isArray(d)&&d.length>c.modelAttribLength)for(var m=d.length-c.modelAttribLength,f=d.length-m,N=0;m>N;N++,f++,c.modelAttribLength++){var h=new n(document.createElement("option"),e,s,f);h.node.text=d[f].text,h.node.value=d[f].value,node.appendChild(h.node),h.scope=p.scope,i.pushNodes(h)}break;case"OPTION":t.isArray(d)&&(d.length<=c.modelAttribLength&&c.modelAttribIndex<d.length&&(node.text=d[c.modelAttribIndex].text,node.value=d[c.modelAttribIndex].value,node.parentNode.selectedIndex=t.isDef(d[c.modelAttribIndex].selected)&&1==d[c.modelAttribIndex].selected?c.modelAttribIndex:node.parentNode.selectedIndex),updateObj.value=node.parentNode.options[node.parentNode.selectedIndex].value,updateObj.text=node.parentNode.options[node.parentNode.selectedIndex].text,updateObj.type=t.MODEL_EVENT_TYPES.interp_change,updateObj.index=node.parentNode.selectedIndex,c.modelAttribIndex>=d.length&&(c.removeItem(c.index),node.parentNode.removeChild(node)));break;case"SPAN":Interpolate.interpolateSpan(p,d),updateObj.text=node.innerText,updateObj.type=node.tagName.toLowerCase();break;case"INPUT":updateObj.text=node.value,updateObj.type=node.tagName.toLowerCase();break;default:var T=null,b=c,g=null;i.forEach(e,s,function(n,r){i.pruneControlNodesByIndex(r,e,s,r.index),n.removeItem(n.index),!t.isNull(r.node.parentNode)&&r.index>t.UNINDEXED&&r.node.parentNode.removeChild(r.node)}),g=i.getRepeatBaseNodes(e,s);for(var E=0;E<g.length;E++){if(TMP_repeatBaseNode=g[E],r.isVisible(TMP_repeatBaseNode.node.parentNode))for(var _=0;_<d.length;_++)i.pruneEmbeddedNodes(TMP_repeatBaseNode,e,s,_),T=l.preProcessRepeatNode(TMP_repeatBaseNode,_),T.scope=TMP_repeatBaseNode.scope,i.pushNodes(T),0==T.hasNonTerminals&&(T.node.innerHTML=d[_]),r.appendTo(T.node,TMP_repeatBaseNode.node),o("Compile").compile(T.node,TMP_repeatBaseNode.scope);TMP_repeatBaseNode.node.setAttribute("style","display:none;")}Interpolate.dispatchSystemListeners(t.SYSTEM_EVENT_TYPES.repeat_built),a.removeSystemListeners(t.SYSTEM_EVENT_TYPES.repeat_built),b.stop=!0,updateObj.type="repeat",updateObj.value=d}}),t.isDef(updateObj.type)&&Interpolate.dispatchListeners(listeners,updateObj)}}}});structureJS.module("Compile",function(e){var t=this,n=e("TMP_Node"),i=e("ControlNodeHeader"),r=e("Map"),l=e("DOM"),a=e("Interpolate"),o=e("Process"),s=e("State"),d=structureJS.circular();return{compile:function(e,u){if(t.isNull(e)||t.isNull(e.childNodes))return u;var p=e.getAttribute("data-apl-default");t.isNullOrEmpty(p)||(e.setAttribute("data-apl-default",""),s.compilationThreadCount++,s.onloadFileQueue.push(p),l.asynGetPartial(p,d("Bootstrap").loadPartialIntoTemplate,null,e),t.log("Spawning Thread <"+p+"> w/ target <"+e.id+"> w/ scope <"+u+">"));for(var c=e.childNodes,m=[],N=null,f=null,T=null,h=null,b=null,g=null,E=[null,null],_=null,v=null,A=null,S=0,D=-1,M="",x="",O="",I="",P="",y=!1,L=/(\{\{(\w+\.\w+)(\[(\d+)\])*(?:\.)*(\w+)*?\}\})/g,R=0;R<c.length;R++)if(b=c[R],T=b.parentNode,b.nodeType!=t.TEXT_NODE||t.isNull(T)||"OPTION"===T.tagName){if(b.nodeType==t.ELEMENT_NODE){var C=l.getDataAttribute(b,t.IE_MODEL_REPEAT_KEY);t.isNullOrEmpty(C)||(E=o.parseModelAttribName(C),O=E[0],I=E[1]),y=o.preProcessNode(b,O,I,u);var w=l.getDataAttribute(b,t.IE_CTRL_ATTRIB_KEY);t.isNullOrEmpty(w)||null===(h=/(\w+)(\|(\w+)\.(\w+)(\.(\d+))*)*/g.exec(w))||(v=new i(b,h[1],h[3],h[4],h[6]),v.scope=u,r.addControlNode(v)),1==y&&this.compile(b,u)}}else{for(M=b.wholeText;null!=(g=L.exec(M));)E=o.parseModelAttribName(g[2]),m.push({start:g.index,end:L.lastIndex,modelName:E[0],attribName:E[1],fullToken:g[1],index:g[4],propertyName:g[5]});for(var j=0;j<m.length;j++){x=T.tagName,O=m[j].modelName,I=m[j].attribName;var f=document.createElement("span");if(P=m[j].propertyName,D=t.isDef(m[j].index)?parseInt(m[j].index):-1,A=new n(f,O,I,D),A.prop=P,t.isNullOrEmpty(P)||P.indexOf("zTMPzDOT")==t.UNINDEXED||(_=P.split("DOT"),A.repeatModelName=_[1],A.repeatAttribName=_[2],A.repeatIndex=D,A.index=t.UNINDEXED,A.prop=""),A.scope=u,N=l.splitText(b,m[j].start-S),S+=b.nodeValue.length,N.nodeValue.trim()==m[j].fullToken&&(A.node.innerText=N.nodeValue,a.interpolateSpan(A,r.getAttribute(O,I)),T.replaceChild(A.node,N),r.pushNodes(A)),b.nodeValue.trim()==m[j].fullToken&&(A.node.innerText=b.nodeValue,a.interpolateSpan(A,r.getAttribute(O,I)),T.replaceChild(A.node,b),r.pushNodes(A)),b=c[++R],b.nodeType!=t.TEXT_NODE)break;if(N=l.splitText(b,m[j].end-S),S+=b.nodeValue.length,N.nodeValue.trim()==m[j].fullToken&&(A.node.innerText=N.nodeValue,a.interpolateSpan(A,r.getAttribute(O,I)),T.replaceChild(A.node,N),r.pushNodes(A)),b.nodeValue.trim()==m[j].fullToken&&(A.node.innerText=b.nodeValue,a.interpolateSpan(A,r.getAttribute(O,I)),T.replaceChild(A.node,b),r.pushNodes(A)),b=c[++R],b.nodeType!=t.TEXT_NODE)break}m.length=0,S=0}return u}}});structureJS.module("Link",function(e){var t=this,n=e("Map"),i=e("Interpolate"),r=e("System");return{bindModel:function(e){Object.create(null);n.forEach(function(t,r){n.forEach(r,function(t){i.interpolate(t.modelName,t.modelAtrribName,n.getAttribute(t.modelName,t.modelAtrribName),e)})}),State.compiledScopes="",i.dispatchSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done),r.removeSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done)}}});structureJS.module("ModelAPI",function(e){var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate");n.prototype.softset=function(e,n){this.cachedResults[e]=n,r.interpolate(this.modelName,e,n),delete this.cachedResults[e],t.isDef(this.limitTable[e])&&(this.limitTable[e].page=1)},n.prototype.update=function(e){r.interpolate(this.modelName,e,i.getAttribute(this.modelName,e))},n.prototype.listen=function(e,t){i.isDuplicateListener(this.modelName,e,t)||i.setListener(this.modelName,e,t)},n.prototype.unlisten=function(e){i.removeListener(this.modelName,e)}});structureJS.module("ModelFilter",function(e){var t=this,n=e("ModelHeader"),i=e("Map"),r=e("Interpolate");n.prototype.sort=function(e,n){var l=Object.create(null),a=this,o=t.isDef(a.limitTable[e])?a.limitTable[e].page:0,s=0,d=-1,u=1,p=0;return l.target=i.getAttribute(a.modelName,e),t.isDef(n)&&n>0&&t.isDef(a.limitTable[e])&&(o=a.limitTable[e].page,a.limitTable[e].page=n,l.target=i.getPageSlice(a,e,l.target)),l.propName="",l.prevProps=[],l.insertSortedSlice=function(e,n,l,a){if(t.isDef(n.limitTable[l])){n.limitTable[l].page=t.isDef(a)?a:o,s=n.limitTable[l].limit,n.limitTable[l].limit=0;var d=i.getAttribute(n.modelName,l);n.limitTable[l].limit=s;var u=r.getPageSliceData(n,l,d),p=null;if(u.start>-1&&!t.isNull(e)){p=d.slice(0);for(var c=0,m=u.start;c<e.length&&m<u.length;c++,m++)p[m]=e[c];i.setAttribute(n.modelName,l,p.slice(0)),n.limitTable[l].page=o}}},l.sorter=function(e,n){var i=e,r=n,e=t.isNull(l.propName)?e:e[l.propName],n=t.isNull(l.propName)?n:n[l.propName],a=parseInt(e),o=parseInt(n),s=!0,c=p;if(!t.isDef(e)||!t.isDef(n))return p;for(var m=0;m<l.prevProps.length;m++)s&=i[l.prevProps[m]]==r[l.prevProps[m]];return e=isNaN(a)?e:a,n=isNaN(o)?n:o,c=n==e?p:e>n?u:d,c=1==s?c:p},l.orderBy=function(t){return l.propName=t,l.target.sort(l.sorter),l.insertSortedSlice(l.target,a,e,n),l.prevProps.push(t),l},l.thenBy=function(t){return l.propName=t,l.target.sort(l.sorter),l.insertSortedSlice(l.target,a,e,n),l.prevProps.push(t),l},l},n.prototype.sortCurrentPageOf=function(e){var n=(Object.create(null),this),i=n.limitTable[e];return t.isDef(i)?n.sort(e,i.currentPage):void 0}});structureJS.module("ModelFilter",function(e){var t=this,n=e("ModelHeader"),r=e("Map"),i=e("Interpolate");n.prototype.limit=function(e){var n=Object.create(null),i=this,l=0,a=0;return n.to=function(n){n>0?(delete i.limitTable[e],l=r.getAttribute(i.modelName,e),t.isArray(l)&&(a=Math.floor(l.length/n),a+=l.length%n>0?1:0,i.limitTable[e]={limit:n,page:1,totalPages:a,currentPage:1},i.update(e))):delete i.limitTable[e]},n},n.prototype.gotoPage=function(e){var n=Object.create(null),l=this,a=null;return n.of=function(n){a=l.limitTable[n],t.isDef(a)&&e>0&&e<=a.totalPages&&(a.page=a.currentPage=e,i.interpolate(l.modelName,n,r.getAttribute(l.modelName,n)))},n},n.prototype.gotoNextPageOf=function(e){var n=this,r=n.limitTable[e];t.isDef(r)&&r.currentPage+1<=r.totalPages&&n.gotoPage(++r.currentPage).of(e)},n.prototype.gotoPreviousPageOf=function(e){var n=this,r=n.limitTable[e];t.isDef(r)&&r.currentPage-1>0&&n.gotoPage(--r.currentPage).of(e)},n.prototype.currentPageOf=function(e){var n=this,r=n.limitTable[e],i=0;return t.isDef(r)&&(i=r.currentPage),i},n.prototype.totalPagesOf=function(e){var n=this,r=n.limitTable[e],i=0;return t.isDef(r)&&(i=r.totalPages),i}});structureJS.module("ModelFilter",function(e){var t=this,n=e("ModelHeader"),r=e("Map"),i=e("Interpolate");n.prototype.filterWarapper=function(e,n,l,a,o,s,u){if(t.isDef(o)&&1==o&&delete this.cachedResults[e],t.isDef(u)&&1==u)return 0==a.call(null,l)?(t.isNullOrEmpty(l)&&i.interpolate(this.modelName,e,r.getAttribute(this.modelName,e)),!1):!0;var d=this,p=[],c=r.getAttribute(d.modelName,e),m=null,f=null;if(c=r.getPageSlice(d,e,c),t.isArray(c)){for(var N=0;N<c.length;N++)f=c[N],itemValue=!t.isNullOrEmpty(n)&&t.isDef(f[n])?f[n]:f,m=1==s?a.call(null,itemValue):a.call(null,l,itemValue),1==m&&p.push(f);p.length<1?(delete d.cachedResults[e],1==o&&(p=r.getAttribute(d.modelName,e),i.interpolate(d.modelName,e,p))):(d.cachedResults[e]=p,t.isDef(s)&&1==s&&(d.filterResults[e]=p),i.interpolate(d.modelName,e,p))}return!0},n.prototype.filter=function(e){var n=Object.create(null),i=this,l=!0,a=void 0;return n.propName="",n.isStatic=!1,n.liveAndFuncs=[],n.using=function(o){return t.isFunc(o)?(l=!1,a=!0,n.isStatic=!0,i.filterWarapper(e,n.propName,null,o,l,a)):(t.isDef(i.liveFilters[e])||(i.liveFilters[e]=[]),i.liveFilters[e].push(o),r.setListener(i.modelName,o,function(r){l=n.liveAndFuncs.length<1;for(var o=!0,s=!1,u=0;u<n.liveAndFuncs.length&&1==o;u++){var d=1==n.liveAndFuncs[u].length;o=n.liveAndFuncs[u].funct.call(null,r.text,n.propName,d),s|=!d}t.log("defaultFilterOverride: "+s),1==o&&0==s&&i.filterWarapper(e,n.propName,r.text,function(e,n){return!t.isNullOrEmpty(n)&&!t.isNullOrEmpty(e)&&0==n.toString().toLowerCase().indexOf(e.toLowerCase())},l,a)},!0)),n},n.by=function(e){return n.propName=e,n},n.and=function(r){return t.isFunc(r)&&(n.liveAndFuncs.push({funct:function(t,o,s){return a=n.isStatic,l=s,i.filterWarapper(e,o,t,r,l,a,s)},length:r.length}),n.liveAndFuncs.sort(function(e){return 1!=e.funct.length}),l=!1,a=n.isStatic,1==(a=n.isStatic)&&i.filterWarapper(e,n.propName,null,r,l,a)),n},n},n.prototype.resetLiveFiltersOf=function(e){var n=null;if(t.isDef(this.liveFilters[e])){n=this.liveFilters[e];for(var i=0;i<n.length;i++)r.removeFilterListeners(this.modelName,n[i])}},n.prototype.resetStaticFiltersOf=function(e){delete this.filterResults[e]}});structureJS.module("ControlNodeAPI",function(e){var t=this,n=e("ControlNodeHeader"),i=e("DOM"),r=(e("Map"),e("System"));n.prototype.indexedWrapper=function(e,n){if(t.isDef(e)&&e<this.controlBaseNodes.length)n.call(null,this.controlBaseNodes[e]);else for(var i=0;i<this.controlBaseNodes.length;i++)n.call(null,this.controlBaseNodes[i])},n.prototype.hide=function(e){this.indexedWrapper(e,function(e){i.modifyClasses(e.node,"apl-hide","apl-show")})},n.prototype.show=function(e){this.indexedWrapper(e,function(e){i.modifyClasses(e.node,"apl-show","apl-hide")})},n.prototype.addClass=function(e,t){this.indexedWrapper(t,function(t){i.modifyClasses(t.node,e,"")})},n.prototype.removeClass=function(e,t){this.indexedWrapper(t,function(t){i.modifyClasses(t.node,"",e)})},n.prototype.listenTo=function(e){var n=Object.create(null),i=this;return n.forEvent=function(n,l){var o=function(e,n,i,r){var l=null,o=null;return function(){if(t.isDef(i)&&!t.isNull(r.controlBaseNodes)&&t.isDef(r.controlBaseNodes[0])&&t.isDef(r.controlBaseNodes[0].childIds[i]))for(var a=0;a<r.controlBaseNodes.length;a++){l=r.controlBaseNodes[a];for(var s in l.childIds)s==i&&(o=l.childIds[s].node,function(t,n,i,r){i.addEventListener(e,function(e){r.childIds.event=e,t.call(null,r.childIds,n),delete r.childIds.event})}(n,a,o,l))}}}(n,l,e,i);t.isNull(i.controlBaseNodes)?r.setSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done,o):o.call(null)},n},n.prototype.forEach=function(e){var n=(Object.create(null),this),i=function(e,t){return function(){for(var n=0;n<e.controlBaseNodes.length;n++)t.call(null,n,e.controlBaseNodes[n],e.controlBaseNodes[n].childIds)}}(n,e);r.setSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done,i),t.isNull(n.controlBaseNodes)||i.call(null)},n.prototype.listen=function(e,n){var i=this,l=function(e,n,i){return function(){if(!t.isNullOrEmpty(e)&&t.isFunc(n)&&!t.isNull(i.controlBaseNodes))for(var r=0;r<i.controlBaseNodes.length;r++)!function(t,n){i.controlBaseNodes[n].node.addEventListener(e,function(e){i.controlBaseNodes[n].childIds.event=e,t.call(null,i.controlBaseNodes[n].childIds,n),delete i.controlBaseNodes[n].childIds.event})}(n,r)}}(e,n,i);t.isNull(i.controlBaseNodes)?r.setSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done,l):l.call(null)}});structureJS.module("Route",function(e){var t=this,n=Object.create(null),r=e("State"),l=e("DOM"),i=e("Map"),o=e("Interpolate"),a=e("Bootstrap");return t.log(a),{routeTree:Object.create(null),buildRouteTree:function(e){for(var l=Object.create(null),i=Object.create(null),o=null,a="",s=null,u=null,d=!1,c=!1,p="",m=null,f=null,N=null,h=null,T="",g="",b=0;b<e.length;b++){m=e[b].route.trim().split("/"),T=e[b].target,g=e[b].partial,s=l,u=i;for(var E=0;E<m.length;E++)""!=m[E]&&"#"!=m[E]&&(f=t.NT_REGEX.test(m[E])?t.NON_TERMINAL:t.TERMINAL,N=E+1<m.length?m[E+1]:null,h=t.isNull(N)?null:t.NT_REGEX.test(N)?t.NON_TERMINAL:t.TERMINAL,a=f==t.NON_TERMINAL?m[E]:m[E].toLowerCase(),o=t.NT_REGEX.test(m[E])?"NT":a,t.isDef(s[a])||(s[a]=Object.create(null),s[a].endOfChain=!1,s[a].lookaheadVal=h==t.NON_TERMINAL?N:"",s[a].lookaheadType=h,d=!0),t.isDef(u[o])||(u[o]=Object.create(null),c=!0),s=s[a],u=u[o],p=e[b].route);if(!d&&1==s.endOfChain)throw'Error: Duplicate Route "'+e[b].route+'" Detected';if(!c)throw'Error: Ambiguous Route "'+e[b].route+'" Detected';s.endOfChain=!0,s.route=p,s.partial=t.isDef(g)?g:"",s.target=t.isDef(T)?T:"",d=!1,c=!1}this.routeTree=n=l,r.hasDeclaredRoutes=!0},resolveRoute:function(e){var r=e.trim().split("/"),l=[],i="";routePart=n;for(var o=0;o<r.length;o++)if(""!=r[o]&&"#"!=r[o]&&(t.isDef(routePart.lookaheadType)&&routePart.lookaheadType==t.NON_TERMINAL?(i=routePart.lookaheadVal,l.push([i,r[o]])):i=r[o].toLowerCase(),routePart=routePart[i],!t.isDef(routePart)))throw'Error: Route "'+e+'" not found';if(1!=routePart.endOfChain)throw'Route "'+e+'" was only a partial match of declared routes.';return t.log("Route matched: "+e+" with "+routePart.route),routePart.nonTerminalValues=l,routePart},handleRoute:function(e){var n=l.getHashValue(e),a="",s=(document.getElementById(a),null),u=null,d=null;if(1==r.hasDeclaredRoutes)try{s=Route.resolveRoute(n),s.target=t.isNullOrEmpty(s.target)?"apl-content":s.target,u=s.nonTerminalValues;for(var c=0;c<u.length;c++)d=u[c][0].split(":"),i.setAttribute(d[0],d[1],u[c][1]),o.interpolate(d[0],d[1],u[c][1])}catch(p){t.log(p)}return s}}});structureJS.module("Templar",function(e){var t=this,n=e("ControlNodeHeader"),r=e("Map"),l=e("Route"),i=e("ModelHeader"),o=e("System"),a=function(e){var l=new n,i=null;l.controlBaseNodes=r.getBaseControls(e);var i=function(e,t){return function(){e.controlBaseNodes=r.getBaseControls(t)}}(l,e);return i.call(null),o.setSystemListeners(t.SYSTEM_EVENT_TYPES.interpolation_done,i),l};return a._onloadHandlerMap=Object.create(null),a.success=function(e,n){t.isDef(this._onloadHandlerMap[e])||(this._onloadHandlerMap[e]=[]),t.isFunc(n)&&this._onloadHandlerMap[e].push(n)},a.getPartialOnlodHandler=function(e){var n=[];return t.isDef(this._onloadHandlerMap[e])&&(n=this._onloadHandlerMap[e]),n},a.getModel=function(e){return r.getModel(e)},a.dataModel=function(e,t){r.initModel(new i(e,t))},a.Route=function(e){l.buildRouteTree(e)},a.RouteObj=l,a.Map=r,window.Templar=a,a});structureJS.module("Bootstrap",function(e){var t=this,n=e("Map"),r=e("Link"),l=e("State"),i=e("Compile"),o=e("DOM"),a={setTarget:function(e){l.target=o.getDataAttribute(e.target,t.IE_TARGET_ATTRIB_KEY),l.target=t.isNullOrEmpty(l.target)?"":l.target},fireOnloads:function(){for(var e="",t=null;e=l.onloadFileQueue.pop();){t=Templar.getPartialOnlodHandler(e);for(var n=0;n<t.length;n++)t[n].call(null)}},bindTargetSetter:function(){var e=document.getElementsByTagName("a");if(null!=e)for(var t=0;t<e.length;t++)e[t].addEventListener("click",this.setTarget)},loadPartialIntoTemplate:function(){var e=this.responseText,s=this.fileName,u=t.isNullOrEmpty(this.targetId)?"apl-content":this.targetId.replace("#",""),d=t.isNull(this.targetNode)?null:this.targetNode,c=null,p=null,m=(document.location.href,(new Date).getTime()),f=s+" "+m;t.isNull(d)?null!=(d=document.getElementById(u))&&(d.innerHTML=e):d.innerHTML=e,c=document.getElementById("apl-hide"),nodesPreviouslyHidden=l.aplHideList.split(t.CLASS_SEPARATOR);for(var N=0;N<nodesPreviouslyHidden.length;N++)p=document.getElementById(nodesPreviouslyHidden[N]),o.modifyClasses(p,"apl-show","apl-show,apl-hide");t.isNull(c)||(l.aplHideList=c.getAttribute("data-apl-hide"),o.hideByIdList(l.aplHideList)),t.log("Compiling <"+s+"> w/ scope <"+f+">"),l.compilationThreadCount--,l.compiledScopes+=f+",",i.compile(d,f),o.modifyClasses(d,"apl-show","apl-hide,apl-show"),l.compilationThreadCount<=0&&(n.pruneNodeTreeByScope(l.compiledScopes),a.fireOnloads(),r.bindModel(l.compiledScopes),a.bindTargetSetter(),l.compilationThreadCount=0)}};return a});structureJS.module("Export",function(e){var t=this;DOM=e("DOM"),Map=e("Map"),State=e("State"),Bootstrap=e("Bootstrap"),Compile=e("Compile"),Templar=e("Templar"),Route=e("Route"),Link=e("Link"),Interpolate=e("Interpolate"),Process=e("Process"),structureJS.done(function(){t.isDef(console)||(console={log:function(){}});var e=(document.getElementById("apl-content"),"body "+(new Date).getTime()),n=null,r=null,l="";window.onhashchange=function(){var e="",t=null;null!=(t=Route.handleRoute(window.location.href))?(State.onloadFileQueue.push(t.partial),DOM.asynGetPartial(t.partial,Bootstrap.loadPartialIntoTemplate,t.target)):(e=DOM.getHashValue(window.location.href),State.onloadFileQueue.push(e),DOM.asynGetPartial(e,Bootstrap.loadPartialIntoTemplate,State.target))},State.compiledScopes+=e+",",null!=(n=Route.handleRoute(window.location.href))&&(t.isNullOrEmpty(n.partial)||(r=document.getElementById(n.target),l=DOM.getDataAttribute(r,t.IE_DEFAULT_ATTRIB_KEY),t.isNull(r)||t.isNullOrEmpty(l)||r.setAttribute("data-"+t.IE_DEFAULT_ATTRIB_KEY,""),State.onloadFileQueue.push(n.partial),DOM.asynGetPartial(n.partial,Bootstrap.loadPartialIntoTemplate,n.target))),Compile.compile(document.getElementsByTagName("body")[0],e),Link.bindModel(State.compiledScopes),Bootstrap.bindTargetSetter();var i=document.querySelectorAll(".apl-default-hidden");if(!t.isNull(i))for(var o=0;o<i.length;o++)defaultNodeToHide=i[o],DOM.modifyClasses(defaultNodeToHide,"","apl-default-hidden");t.log("Body COMPILATION DONE")})});